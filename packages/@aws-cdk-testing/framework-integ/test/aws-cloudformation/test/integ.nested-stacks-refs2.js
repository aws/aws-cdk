"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/// !cdk-integ *
const sns = require("aws-cdk-lib/aws-sns");
const aws_cdk_lib_1 = require("aws-cdk-lib");
// non-nested non-parent stack consumes a resource from a nested stack
class ProducerNestedStack extends aws_cdk_lib_1.NestedStack {
    constructor(scope, id) {
        super(scope, id);
        this.topic = new sns.Topic(this, 'MyTopic');
    }
}
class ParentStack extends aws_cdk_lib_1.Stack {
    constructor(scope, id) {
        super(scope, id);
        const nested = new ProducerNestedStack(this, 'Nested1');
        this.topic = nested.topic;
    }
}
class ConsumerStack extends aws_cdk_lib_1.Stack {
    constructor(scope, id, topic) {
        super(scope, id);
        new sns.Topic(this, 'ConsumerTopic', {
            displayName: `Consuming ${aws_cdk_lib_1.Fn.select(2, aws_cdk_lib_1.Fn.split('-', topic.topicName))}`, // just shorten because display name is limited
        });
    }
}
const app = new aws_cdk_lib_1.App();
const parent = new ParentStack(app, 'nested-stacks-refs2-parent-with-producer');
new ConsumerStack(app, 'nested-stacks-refs2-consumer', parent.topic);
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcubmVzdGVkLXN0YWNrcy1yZWZzMi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLm5lc3RlZC1zdGFja3MtcmVmczIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxnQkFBZ0I7QUFDaEIsMkNBQTJDO0FBQzNDLDZDQUEwRDtBQUcxRCxzRUFBc0U7QUFFdEUsTUFBTSxtQkFBb0IsU0FBUSx5QkFBVztJQUczQyxZQUFZLEtBQWdCLEVBQUUsRUFBVTtRQUN0QyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRWpCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztJQUM5QyxDQUFDO0NBQ0Y7QUFFRCxNQUFNLFdBQVksU0FBUSxtQkFBSztJQUc3QixZQUFZLEtBQWdCLEVBQUUsRUFBVTtRQUN0QyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRWpCLE1BQU0sTUFBTSxHQUFHLElBQUksbUJBQW1CLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ3hELElBQUksQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQztJQUM1QixDQUFDO0NBQ0Y7QUFFRCxNQUFNLGFBQWMsU0FBUSxtQkFBSztJQUMvQixZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQWdCO1FBQ3hELEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFakIsSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxlQUFlLEVBQUU7WUFDbkMsV0FBVyxFQUFFLGFBQWEsZ0JBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLGdCQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxFQUFFLCtDQUErQztTQUMxSCxDQUFDLENBQUM7SUFDTCxDQUFDO0NBQ0Y7QUFFRCxNQUFNLEdBQUcsR0FBRyxJQUFJLGlCQUFHLEVBQUUsQ0FBQztBQUN0QixNQUFNLE1BQU0sR0FBRyxJQUFJLFdBQVcsQ0FBQyxHQUFHLEVBQUUsMENBQTBDLENBQUMsQ0FBQztBQUNoRixJQUFJLGFBQWEsQ0FBQyxHQUFHLEVBQUUsOEJBQThCLEVBQUUsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3JFLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyAhY2RrLWludGVnICpcbmltcG9ydCAqIGFzIHNucyBmcm9tICdhd3MtY2RrLWxpYi9hd3Mtc25zJztcbmltcG9ydCB7IEFwcCwgRm4sIE5lc3RlZFN0YWNrLCBTdGFjayB9IGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuXG4vLyBub24tbmVzdGVkIG5vbi1wYXJlbnQgc3RhY2sgY29uc3VtZXMgYSByZXNvdXJjZSBmcm9tIGEgbmVzdGVkIHN0YWNrXG5cbmNsYXNzIFByb2R1Y2VyTmVzdGVkU3RhY2sgZXh0ZW5kcyBOZXN0ZWRTdGFjayB7XG4gIHB1YmxpYyByZWFkb25seSB0b3BpYzogc25zLlRvcGljO1xuXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcpIHtcbiAgICBzdXBlcihzY29wZSwgaWQpO1xuXG4gICAgdGhpcy50b3BpYyA9IG5ldyBzbnMuVG9waWModGhpcywgJ015VG9waWMnKTtcbiAgfVxufVxuXG5jbGFzcyBQYXJlbnRTdGFjayBleHRlbmRzIFN0YWNrIHtcbiAgcHVibGljIHJlYWRvbmx5IHRvcGljOiBzbnMuVG9waWM7XG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgUHJvZHVjZXJOZXN0ZWRTdGFjayh0aGlzLCAnTmVzdGVkMScpO1xuICAgIHRoaXMudG9waWMgPSBuZXN0ZWQudG9waWM7XG4gIH1cbn1cblxuY2xhc3MgQ29uc3VtZXJTdGFjayBleHRlbmRzIFN0YWNrIHtcbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgdG9waWM6IHNucy5Ub3BpYykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICBuZXcgc25zLlRvcGljKHRoaXMsICdDb25zdW1lclRvcGljJywge1xuICAgICAgZGlzcGxheU5hbWU6IGBDb25zdW1pbmcgJHtGbi5zZWxlY3QoMiwgRm4uc3BsaXQoJy0nLCB0b3BpYy50b3BpY05hbWUpKX1gLCAvLyBqdXN0IHNob3J0ZW4gYmVjYXVzZSBkaXNwbGF5IG5hbWUgaXMgbGltaXRlZFxuICAgIH0pO1xuICB9XG59XG5cbmNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcbmNvbnN0IHBhcmVudCA9IG5ldyBQYXJlbnRTdGFjayhhcHAsICduZXN0ZWQtc3RhY2tzLXJlZnMyLXBhcmVudC13aXRoLXByb2R1Y2VyJyk7XG5uZXcgQ29uc3VtZXJTdGFjayhhcHAsICduZXN0ZWQtc3RhY2tzLXJlZnMyLWNvbnN1bWVyJywgcGFyZW50LnRvcGljKTtcbmFwcC5zeW50aCgpO1xuIl19