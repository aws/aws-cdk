"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const aws_cognito_1 = require("aws-cdk-lib/aws-cognito");
const aws_dynamodb_1 = require("aws-cdk-lib/aws-dynamodb");
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_appsync_1 = require("aws-cdk-lib/aws-appsync");
/*
 * Creates an Appsync GraphQL API and with multiple tables.
 * Testing for importing, querying, and mutability.
 *
 * Stack verification steps:
 * Add to a table through appsync GraphQL API.
 * Read from a table through appsync API.
 *
 * -- aws appsync list-graphql-apis                 -- obtain apiId               --
 * -- aws appsync get-graphql-api --api-id [apiId]  -- obtain GraphQL endpoint    --
 * -- aws appsync list-api-keys --api-id [apiId]    -- obtain api key             --
 * -- bash verify.integ.graphql.sh [apiKey] [url]   -- shows query and mutation   --
 */
const app = new aws_cdk_lib_1.App();
const stack = new aws_cdk_lib_1.Stack(app, 'aws-appsync-integ');
const userPool = new aws_cognito_1.UserPool(stack, 'Pool', {
    userPoolName: 'myPool',
});
const api = new aws_appsync_1.GraphqlApi(stack, 'Api', {
    name: 'demoapi',
    schema: aws_appsync_1.SchemaFile.fromAsset((0, path_1.join)(__dirname, 'integ.graphql.graphql')),
    authorizationConfig: {
        defaultAuthorization: {
            authorizationType: aws_appsync_1.AuthorizationType.USER_POOL,
            userPoolConfig: {
                userPool,
            },
        },
        additionalAuthorizationModes: [
            {
                authorizationType: aws_appsync_1.AuthorizationType.API_KEY,
            },
        ],
    },
});
const noneDS = api.addNoneDataSource('none', { name: 'None' });
noneDS.createResolver('QuerygetServiceVersion', {
    typeName: 'Query',
    fieldName: 'getServiceVersion',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.fromString(JSON.stringify({
        version: '2017-02-28',
    })),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.fromString(JSON.stringify({
        version: 'v1',
    })),
});
const customerTable = new aws_dynamodb_1.Table(stack, 'CustomerTable', {
    billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
    partitionKey: {
        name: 'id',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    removalPolicy: aws_cdk_lib_1.RemovalPolicy.DESTROY,
});
const orderTable = new aws_dynamodb_1.Table(stack, 'OrderTable', {
    billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
    partitionKey: {
        name: 'customer',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    sortKey: {
        name: 'order',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    removalPolicy: aws_cdk_lib_1.RemovalPolicy.DESTROY,
});
orderTable.addGlobalSecondaryIndex({
    indexName: 'orderIndex',
    partitionKey: {
        name: 'order',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    sortKey: {
        name: 'customer',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
});
new aws_dynamodb_1.Table(stack, 'PaymentTable', {
    billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
    partitionKey: {
        name: 'id',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    removalPolicy: aws_cdk_lib_1.RemovalPolicy.DESTROY,
});
const paymentTable = aws_dynamodb_1.Table.fromTableName(stack, 'ImportedPaymentTable', 'PaymentTable');
const customerDS = api.addDynamoDbDataSource('customerDs', customerTable, { name: 'Customer' });
const orderDS = api.addDynamoDbDataSource('orderDs', orderTable, { name: 'Order' });
const paymentDS = api.addDynamoDbDataSource('paymentDs', paymentTable, { name: 'Payment' });
customerDS.createResolver('QueryGetCustomers', {
    typeName: 'Query',
    fieldName: 'getCustomers',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbScanTable(),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
customerDS.createResolver('QueryGetCustomer', {
    typeName: 'Query',
    fieldName: 'getCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('QueryGetCusomtersNotConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomersNotConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbScanTable(false),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
customerDS.createResolver('QueryGetCustomerNotConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomerNotConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id', false),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('QueryGetCustomersConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomersConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbScanTable(true),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
customerDS.createResolver('QueryGetCustomerConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomerConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id', true),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationAddCustomer', {
    typeName: 'Mutation',
    fieldName: 'addCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey.partition('id').auto(), aws_appsync_1.Values.projecting('customer')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationSaveCustomer', {
    typeName: 'Mutation',
    fieldName: 'saveCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey.partition('id').is('id'), aws_appsync_1.Values.projecting('customer')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationSaveCustomerWithFirstOrder', {
    typeName: 'Mutation',
    fieldName: 'saveCustomerWithFirstOrder',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey
        .partition('order').auto()
        .sort('customer').is('customer.id'), aws_appsync_1.Values
        .projecting('order')
        .attribute('referral').is('referral')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationRemoveCustomer', {
    typeName: 'Mutation',
    fieldName: 'removeCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbDeleteItem('id', 'id'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
const ops = [
    { suffix: 'Eq', op: aws_appsync_1.KeyCondition.eq },
    { suffix: 'Lt', op: aws_appsync_1.KeyCondition.lt },
    { suffix: 'Le', op: aws_appsync_1.KeyCondition.le },
    { suffix: 'Gt', op: aws_appsync_1.KeyCondition.gt },
    { suffix: 'Ge', op: aws_appsync_1.KeyCondition.ge },
];
for (const { suffix, op } of ops) {
    orderDS.createResolver(`QueryGetCustomerOrders${suffix}`, {
        typeName: 'Query',
        fieldName: 'getCustomerOrders' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('customer', 'customer')),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
    orderDS.createResolver(`QueryGetOrderCustomers${suffix}`, {
        typeName: 'Query',
        fieldName: 'getOrderCustomers' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('order', 'order'), 'orderIndex'),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
}
for (const { suffix, op } of ops) {
    orderDS.createResolver(`QueryGetCustomerOrdersNotConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getCustomerOrdersNotConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('customer', 'customer'), undefined, false),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
    orderDS.createResolver(`QueryGetOrderCustomersNotConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getOrderCustomersNotConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('order', 'order'), 'orderIndex', false),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
}
for (const { suffix, op } of ops) {
    orderDS.createResolver(`QueryGetCustomerOrdersConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getCustomerOrdersConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('customer', 'customer'), undefined, true),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
    orderDS.createResolver(`QueryGetOrderCustomersConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getOrderCustomersConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('order', 'order'), 'orderIndex', true),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
}
orderDS.createResolver('QueryGetCustomerOrdersFilter', {
    typeName: 'Query',
    fieldName: 'getCustomerOrdersFilter',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('customer', 'customer').and(aws_appsync_1.KeyCondition.beginsWith('order', 'order'))),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
orderDS.createResolver('QueryGetCustomerOrdersBetween', {
    typeName: 'Query',
    fieldName: 'getCustomerOrdersBetween',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('customer', 'customer').and(aws_appsync_1.KeyCondition.between('order', 'order1', 'order2'))),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
orderDS.createResolver('QueryGetOrderCustomersFilter', {
    typeName: 'Query',
    fieldName: 'getOrderCustomersFilter',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('order', 'order').and(aws_appsync_1.KeyCondition.beginsWith('customer', 'customer'))),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
orderDS.createResolver('QueryGetOrderCustomersBetween', {
    typeName: 'Query',
    fieldName: 'getOrderCustomersBetween',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('order', 'order').and(aws_appsync_1.KeyCondition.between('customer', 'customer1', 'customer2')), 'orderIndex'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
paymentDS.createResolver('QueryGetPayment', {
    typeName: 'Query',
    fieldName: 'getPayment',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
paymentDS.createResolver('QueryGetPaymentConsistent', {
    typeName: 'Query',
    fieldName: 'getPaymentConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id', true),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
paymentDS.createResolver('MutationSavePayment', {
    typeName: 'Mutation',
    fieldName: 'savePayment',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey.partition('id').auto(), aws_appsync_1.Values.projecting('payment')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
const httpDS = api.addHttpDataSource('ds', 'https://aws.amazon.com/', { name: 'http' });
httpDS.createResolver('MutationDoPostOnAws', {
    typeName: 'Mutation',
    fieldName: 'doPostOnAws',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.fromString(`{
    "version": "2018-05-29",
    "method": "POST",
    # if full path is https://api.xxxxxxxxx.com/posts then resourcePath would be /posts
    "resourcePath": "/path/123",
    "params":{
        "body": $util.toJson($ctx.args),
        "headers":{
            "Content-Type": "application/json",
            "Authorization": "$ctx.request.headers.Authorization"
        }
    }
  }`),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.fromString(`
    ## Raise a GraphQL field error in case of a datasource invocation error
    #if($ctx.error)
      $util.error($ctx.error.message, $ctx.error.type)
    #end
    ## if the response status code is not 200, then return an error. Else return the body **
    #if($ctx.result.statusCode == 200)
        ## If response is 200, return the body.
        $ctx.result.body
    #else
        ## If response is not 200, append the response to error block.
        $utils.appendError($ctx.result.body, "$ctx.result.statusCode")
    #end
  `),
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcuZ3JhcGhxbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLmdyYXBocWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQkFBNEI7QUFDNUIseURBQW1EO0FBQ25ELDJEQUE2RTtBQUM3RSw2Q0FBd0Q7QUFDeEQseURBUWlDO0FBRWpDOzs7Ozs7Ozs7Ozs7R0FZRztBQUVILE1BQU0sR0FBRyxHQUFHLElBQUksaUJBQUcsRUFBRSxDQUFDO0FBQ3RCLE1BQU0sS0FBSyxHQUFHLElBQUksbUJBQUssQ0FBQyxHQUFHLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztBQUVsRCxNQUFNLFFBQVEsR0FBRyxJQUFJLHNCQUFRLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRTtJQUMzQyxZQUFZLEVBQUUsUUFBUTtDQUN2QixDQUFDLENBQUM7QUFFSCxNQUFNLEdBQUcsR0FBRyxJQUFJLHdCQUFVLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRTtJQUN2QyxJQUFJLEVBQUUsU0FBUztJQUNmLE1BQU0sRUFBRSx3QkFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFBLFdBQUksRUFBQyxTQUFTLEVBQUUsdUJBQXVCLENBQUMsQ0FBQztJQUN0RSxtQkFBbUIsRUFBRTtRQUNuQixvQkFBb0IsRUFBRTtZQUNwQixpQkFBaUIsRUFBRSwrQkFBaUIsQ0FBQyxTQUFTO1lBQzlDLGNBQWMsRUFBRTtnQkFDZCxRQUFRO2FBQ1Q7U0FDRjtRQUNELDRCQUE0QixFQUFFO1lBQzVCO2dCQUNFLGlCQUFpQixFQUFFLCtCQUFpQixDQUFDLE9BQU87YUFDN0M7U0FDRjtLQUNGO0NBQ0YsQ0FBQyxDQUFDO0FBRUgsTUFBTSxNQUFNLEdBQUcsR0FBRyxDQUFDLGlCQUFpQixDQUFDLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO0FBRS9ELE1BQU0sQ0FBQyxjQUFjLENBQUMsd0JBQXdCLEVBQUU7SUFDOUMsUUFBUSxFQUFFLE9BQU87SUFDakIs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QjtJQUNqQyxzQkFBc0IsRUFBRSw2QkFBZSxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUN6RSx1QkFBdUIsRUFBRSw2QkFBZSxDQUFDLGtCQUFrQixFQUFFO0NBQzlELENBQUMsQ0FBQztBQUNILFNBQVMsQ0FBQyxjQUFjLENBQUMscUJBQXFCLEVBQUU7SUFDOUMsUUFBUSxFQUFFLFVBQVU7SUFDcEIsU0FBUyxFQUFFLGFBQWE7SUFDeEIsc0JBQXNCLEVBQUUsNkJBQWUsQ0FBQyxlQUFlLENBQUMsd0JBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsb0JBQU0sQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDeEgsdUJBQXVCLEVBQUUsNkJBQWUsQ0FBQyxrQkFBa0IsRUFBRTtDQUM5RCxDQUFDLENBQUM7QUFFSCxNQUFNLE1BQU0sR0FBRyxHQUFHLENBQUMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLHlCQUF5QixFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7QUFFeEYsTUFBTSxDQUFDLGNBQWMsQ0FBQyxxQkFBcUIsRUFBRTtJQUMzQyxRQUFRLEVBQUUsVUFBVTtJQUNwQixTQUFTLEVBQUUsYUFBYTtJQUN4QixzQkFBc0IsRUFBRSw2QkFBZSxDQUFDLFVBQVUsQ0FBQzs7Ozs7Ozs7Ozs7O0lBWWpELENBQUM7SUFDSCx1QkFBdUIsRUFBRSw2QkFBZSxDQUFDLFVBQVUsQ0FBQzs7Ozs7Ozs7Ozs7OztHQWFuRCxDQUFDO0NBQ0gsQ0FBQyxDQUFDO0FBRUgsR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgam9pbiB9IGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgVXNlclBvb2wgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtY29nbml0byc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVUeXBlLCBCaWxsaW5nTW9kZSwgVGFibGUgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZHluYW1vZGInO1xuaW1wb3J0IHsgQXBwLCBSZW1vdmFsUG9saWN5LCBTdGFjayB9IGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7XG4gIEF1dGhvcml6YXRpb25UeXBlLFxuICBHcmFwaHFsQXBpLFxuICBLZXlDb25kaXRpb24sXG4gIE1hcHBpbmdUZW1wbGF0ZSxcbiAgUHJpbWFyeUtleSxcbiAgU2NoZW1hRmlsZSxcbiAgVmFsdWVzLFxufSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYXBwc3luYyc7XG5cbi8qXG4gKiBDcmVhdGVzIGFuIEFwcHN5bmMgR3JhcGhRTCBBUEkgYW5kIHdpdGggbXVsdGlwbGUgdGFibGVzLlxuICogVGVzdGluZyBmb3IgaW1wb3J0aW5nLCBxdWVyeWluZywgYW5kIG11dGFiaWxpdHkuXG4gKlxuICogU3RhY2sgdmVyaWZpY2F0aW9uIHN0ZXBzOlxuICogQWRkIHRvIGEgdGFibGUgdGhyb3VnaCBhcHBzeW5jIEdyYXBoUUwgQVBJLlxuICogUmVhZCBmcm9tIGEgdGFibGUgdGhyb3VnaCBhcHBzeW5jIEFQSS5cbiAqXG4gKiAtLSBhd3MgYXBwc3luYyBsaXN0LWdyYXBocWwtYXBpcyAgICAgICAgICAgICAgICAgLS0gb2J0YWluIGFwaUlkICAgICAgICAgICAgICAgLS1cbiAqIC0tIGF3cyBhcHBzeW5jIGdldC1ncmFwaHFsLWFwaSAtLWFwaS1pZCBbYXBpSWRdICAtLSBvYnRhaW4gR3JhcGhRTCBlbmRwb2ludCAgICAtLVxuICogLS0gYXdzIGFwcHN5bmMgbGlzdC1hcGkta2V5cyAtLWFwaS1pZCBbYXBpSWRdICAgIC0tIG9idGFpbiBhcGkga2V5ICAgICAgICAgICAgIC0tXG4gKiAtLSBiYXNoIHZlcmlmeS5pbnRlZy5ncmFwaHFsLnNoIFthcGlLZXldIFt1cmxdICAgLS0gc2hvd3MgcXVlcnkgYW5kIG11dGF0aW9uICAgLS1cbiAqL1xuXG5jb25zdCBhcHAgPSBuZXcgQXBwKCk7XG5jb25zdCBzdGFjayA9IG5ldyBTdGFjayhhcHAsICdhd3MtYXBwc3luYy1pbnRlZycpO1xuXG5jb25zdCB1c2VyUG9vbCA9IG5ldyBVc2VyUG9vbChzdGFjaywgJ1Bvb2wnLCB7XG4gIHVzZXJQb29sTmFtZTogJ215UG9vbCcsXG59KTtcblxuY29uc3QgYXBpID0gbmV3IEdyYXBocWxBcGkoc3RhY2ssICdBcGknLCB7XG4gIG5hbWU6ICdkZW1vYXBpJyxcbiAgc2NoZW1hOiBTY2hlbWFGaWxlLmZyb21Bc3NldChqb2luKF9fZGlybmFtZSwgJ2ludGVnLmdyYXBocWwuZ3JhcGhxbCcpKSxcbiAgYXV0aG9yaXphdGlvbkNvbmZpZzoge1xuICAgIGRlZmF1bHRBdXRob3JpemF0aW9uOiB7XG4gICAgICBhdXRob3JpemF0aW9uVHlwZTogQXV0aG9yaXphdGlvblR5cGUuVVNFUl9QT09MLFxuICAgICAgdXNlclBvb2xDb25maWc6IHtcbiAgICAgICAgdXNlclBvb2wsXG4gICAgICB9LFxuICAgIH0sXG4gICAgYWRkaXRpb25hbEF1dGhvcml6YXRpb25Nb2RlczogW1xuICAgICAge1xuICAgICAgICBhdXRob3JpemF0aW9uVHlwZTogQXV0aG9yaXphdGlvblR5cGUuQVBJX0tFWSxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSxcbn0pO1xuXG5jb25zdCBub25lRFMgPSBhcGkuYWRkTm9uZURhdGFTb3VyY2UoJ25vbmUnLCB7IG5hbWU6ICdOb25lJyB9KTtcblxubm9uZURTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeWdldFNlcnZpY2VWZXJzaW9uJywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0U2VydmljZVZlcnNpb24nLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZnJvbVN0cmluZyhKU09OLnN0cmluZ2lmeSh7XG4gICAgdmVyc2lvbjogJzIwMTctMDItMjgnLFxuICB9KSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZnJvbVN0cmluZyhKU09OLnN0cmluZ2lmeSh7XG4gICAgdmVyc2lvbjogJ3YxJyxcbiAgfSkpLFxufSk7XG5cbmNvbnN0IGN1c3RvbWVyVGFibGUgPSBuZXcgVGFibGUoc3RhY2ssICdDdXN0b21lclRhYmxlJywge1xuICBiaWxsaW5nTW9kZTogQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICBwYXJ0aXRpb25LZXk6IHtcbiAgICBuYW1lOiAnaWQnLFxuICAgIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HLFxuICB9LFxuICByZW1vdmFsUG9saWN5OiBSZW1vdmFsUG9saWN5LkRFU1RST1ksXG59KTtcbmNvbnN0IG9yZGVyVGFibGUgPSBuZXcgVGFibGUoc3RhY2ssICdPcmRlclRhYmxlJywge1xuICBiaWxsaW5nTW9kZTogQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICBwYXJ0aXRpb25LZXk6IHtcbiAgICBuYW1lOiAnY3VzdG9tZXInLFxuICAgIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HLFxuICB9LFxuICBzb3J0S2V5OiB7XG4gICAgbmFtZTogJ29yZGVyJyxcbiAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgfSxcbiAgcmVtb3ZhbFBvbGljeTogUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxufSk7XG5vcmRlclRhYmxlLmFkZEdsb2JhbFNlY29uZGFyeUluZGV4KHtcbiAgaW5kZXhOYW1lOiAnb3JkZXJJbmRleCcsXG4gIHBhcnRpdGlvbktleToge1xuICAgIG5hbWU6ICdvcmRlcicsXG4gICAgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcsXG4gIH0sXG4gIHNvcnRLZXk6IHtcbiAgICBuYW1lOiAnY3VzdG9tZXInLFxuICAgIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HLFxuICB9LFxufSk7XG5cbm5ldyBUYWJsZShzdGFjaywgJ1BheW1lbnRUYWJsZScsIHtcbiAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgcGFydGl0aW9uS2V5OiB7XG4gICAgbmFtZTogJ2lkJyxcbiAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgfSxcbiAgcmVtb3ZhbFBvbGljeTogUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxufSk7XG5cbmNvbnN0IHBheW1lbnRUYWJsZSA9IFRhYmxlLmZyb21UYWJsZU5hbWUoc3RhY2ssICdJbXBvcnRlZFBheW1lbnRUYWJsZScsICdQYXltZW50VGFibGUnKTtcblxuY29uc3QgY3VzdG9tZXJEUyA9IGFwaS5hZGREeW5hbW9EYkRhdGFTb3VyY2UoJ2N1c3RvbWVyRHMnLCBjdXN0b21lclRhYmxlLCB7IG5hbWU6ICdDdXN0b21lcicgfSk7XG5jb25zdCBvcmRlckRTID0gYXBpLmFkZER5bmFtb0RiRGF0YVNvdXJjZSgnb3JkZXJEcycsIG9yZGVyVGFibGUsIHsgbmFtZTogJ09yZGVyJyB9KTtcbmNvbnN0IHBheW1lbnREUyA9IGFwaS5hZGREeW5hbW9EYkRhdGFTb3VyY2UoJ3BheW1lbnREcycsIHBheW1lbnRUYWJsZSwgeyBuYW1lOiAnUGF5bWVudCcgfSk7XG5cbmN1c3RvbWVyRFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0Q3VzdG9tZXJzJywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0Q3VzdG9tZXJzJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiU2NhblRhYmxlKCksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG59KTtcbmN1c3RvbWVyRFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0Q3VzdG9tZXInLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lcicsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYkdldEl0ZW0oJ2lkJywgJ2lkJyksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcbmN1c3RvbWVyRFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0Q3Vzb210ZXJzTm90Q29uc2lzdGVudCcsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVyc05vdENvbnNpc3RlbnQnLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJTY2FuVGFibGUoZmFsc2UpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c3RvbWVyTm90Q29uc2lzdGVudCcsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVyTm90Q29uc2lzdGVudCcsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYkdldEl0ZW0oJ2lkJywgJ2lkJywgZmFsc2UpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0SXRlbSgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c3RvbWVyc0NvbnNpc3RlbnQnLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lcnNDb25zaXN0ZW50JyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiU2NhblRhYmxlKHRydWUpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c3RvbWVyQ29uc2lzdGVudCcsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVyQ29uc2lzdGVudCcsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYkdldEl0ZW0oJ2lkJywgJ2lkJywgdHJ1ZSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcbmN1c3RvbWVyRFMuY3JlYXRlUmVzb2x2ZXIoJ011dGF0aW9uQWRkQ3VzdG9tZXInLCB7XG4gIHR5cGVOYW1lOiAnTXV0YXRpb24nLFxuICBmaWVsZE5hbWU6ICdhZGRDdXN0b21lcicsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlB1dEl0ZW0oUHJpbWFyeUtleS5wYXJ0aXRpb24oJ2lkJykuYXV0bygpLCBWYWx1ZXMucHJvamVjdGluZygnY3VzdG9tZXInKSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcbmN1c3RvbWVyRFMuY3JlYXRlUmVzb2x2ZXIoJ011dGF0aW9uU2F2ZUN1c3RvbWVyJywge1xuICB0eXBlTmFtZTogJ011dGF0aW9uJyxcbiAgZmllbGROYW1lOiAnc2F2ZUN1c3RvbWVyJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUHV0SXRlbShQcmltYXJ5S2V5LnBhcnRpdGlvbignaWQnKS5pcygnaWQnKSwgVmFsdWVzLnByb2plY3RpbmcoJ2N1c3RvbWVyJykpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0SXRlbSgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdNdXRhdGlvblNhdmVDdXN0b21lcldpdGhGaXJzdE9yZGVyJywge1xuICB0eXBlTmFtZTogJ011dGF0aW9uJyxcbiAgZmllbGROYW1lOiAnc2F2ZUN1c3RvbWVyV2l0aEZpcnN0T3JkZXInLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJQdXRJdGVtKFxuICAgIFByaW1hcnlLZXlcbiAgICAgIC5wYXJ0aXRpb24oJ29yZGVyJykuYXV0bygpXG4gICAgICAuc29ydCgnY3VzdG9tZXInKS5pcygnY3VzdG9tZXIuaWQnKSxcbiAgICBWYWx1ZXNcbiAgICAgIC5wcm9qZWN0aW5nKCdvcmRlcicpXG4gICAgICAuYXR0cmlidXRlKCdyZWZlcnJhbCcpLmlzKCdyZWZlcnJhbCcpKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdEl0ZW0oKSxcbn0pO1xuY3VzdG9tZXJEUy5jcmVhdGVSZXNvbHZlcignTXV0YXRpb25SZW1vdmVDdXN0b21lcicsIHtcbiAgdHlwZU5hbWU6ICdNdXRhdGlvbicsXG4gIGZpZWxkTmFtZTogJ3JlbW92ZUN1c3RvbWVyJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiRGVsZXRlSXRlbSgnaWQnLCAnaWQnKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdEl0ZW0oKSxcbn0pO1xuXG5jb25zdCBvcHMgPSBbXG4gIHsgc3VmZml4OiAnRXEnLCBvcDogS2V5Q29uZGl0aW9uLmVxIH0sXG4gIHsgc3VmZml4OiAnTHQnLCBvcDogS2V5Q29uZGl0aW9uLmx0IH0sXG4gIHsgc3VmZml4OiAnTGUnLCBvcDogS2V5Q29uZGl0aW9uLmxlIH0sXG4gIHsgc3VmZml4OiAnR3QnLCBvcDogS2V5Q29uZGl0aW9uLmd0IH0sXG4gIHsgc3VmZml4OiAnR2UnLCBvcDogS2V5Q29uZGl0aW9uLmdlIH0sXG5dO1xuZm9yIChjb25zdCB7IHN1ZmZpeCwgb3AgfSBvZiBvcHMpIHtcbiAgb3JkZXJEUy5jcmVhdGVSZXNvbHZlcihgUXVlcnlHZXRDdXN0b21lck9yZGVycyR7c3VmZml4fWAsIHtcbiAgICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lck9yZGVycycgKyBzdWZmaXgsXG4gICAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkob3AoJ2N1c3RvbWVyJywgJ2N1c3RvbWVyJykpLFxuICAgIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG4gIH0pO1xuICBvcmRlckRTLmNyZWF0ZVJlc29sdmVyKGBRdWVyeUdldE9yZGVyQ3VzdG9tZXJzJHtzdWZmaXh9YCwge1xuICAgIHR5cGVOYW1lOiAnUXVlcnknLFxuICAgIGZpZWxkTmFtZTogJ2dldE9yZGVyQ3VzdG9tZXJzJyArIHN1ZmZpeCxcbiAgICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJRdWVyeShvcCgnb3JkZXInLCAnb3JkZXInKSwgJ29yZGVySW5kZXgnKSxcbiAgICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxuICB9KTtcbn1cbmZvciAoY29uc3QgeyBzdWZmaXgsIG9wIH0gb2Ygb3BzKSB7XG4gIG9yZGVyRFMuY3JlYXRlUmVzb2x2ZXIoYFF1ZXJ5R2V0Q3VzdG9tZXJPcmRlcnNOb3RDb25zaXN0ZW50JHtzdWZmaXh9YCwge1xuICAgIHR5cGVOYW1lOiAnUXVlcnknLFxuICAgIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVyT3JkZXJzTm90Q29uc2lzdGVudCcgKyBzdWZmaXgsXG4gICAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkob3AoJ2N1c3RvbWVyJywgJ2N1c3RvbWVyJyksIHVuZGVmaW5lZCwgZmFsc2UpLFxuICAgIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG4gIH0pO1xuICBvcmRlckRTLmNyZWF0ZVJlc29sdmVyKGBRdWVyeUdldE9yZGVyQ3VzdG9tZXJzTm90Q29uc2lzdGVudCR7c3VmZml4fWAsIHtcbiAgICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgICBmaWVsZE5hbWU6ICdnZXRPcmRlckN1c3RvbWVyc05vdENvbnNpc3RlbnQnICsgc3VmZml4LFxuICAgIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlF1ZXJ5KG9wKCdvcmRlcicsICdvcmRlcicpLCAnb3JkZXJJbmRleCcsIGZhbHNlKSxcbiAgICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxuICB9KTtcbn1cbmZvciAoY29uc3QgeyBzdWZmaXgsIG9wIH0gb2Ygb3BzKSB7XG4gIG9yZGVyRFMuY3JlYXRlUmVzb2x2ZXIoYFF1ZXJ5R2V0Q3VzdG9tZXJPcmRlcnNDb25zaXN0ZW50JHtzdWZmaXh9YCwge1xuICAgIHR5cGVOYW1lOiAnUXVlcnknLFxuICAgIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVyT3JkZXJzQ29uc2lzdGVudCcgKyBzdWZmaXgsXG4gICAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkob3AoJ2N1c3RvbWVyJywgJ2N1c3RvbWVyJyksIHVuZGVmaW5lZCwgdHJ1ZSksXG4gICAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbiAgfSk7XG4gIG9yZGVyRFMuY3JlYXRlUmVzb2x2ZXIoYFF1ZXJ5R2V0T3JkZXJDdXN0b21lcnNDb25zaXN0ZW50JHtzdWZmaXh9YCwge1xuICAgIHR5cGVOYW1lOiAnUXVlcnknLFxuICAgIGZpZWxkTmFtZTogJ2dldE9yZGVyQ3VzdG9tZXJzQ29uc2lzdGVudCcgKyBzdWZmaXgsXG4gICAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkob3AoJ29yZGVyJywgJ29yZGVyJyksICdvcmRlckluZGV4JywgdHJ1ZSksXG4gICAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbiAgfSk7XG59XG5vcmRlckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c3RvbWVyT3JkZXJzRmlsdGVyJywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0Q3VzdG9tZXJPcmRlcnNGaWx0ZXInLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJRdWVyeShcbiAgICBLZXlDb25kaXRpb24uZXEoJ2N1c3RvbWVyJywgJ2N1c3RvbWVyJykuYW5kKEtleUNvbmRpdGlvbi5iZWdpbnNXaXRoKCdvcmRlcicsICdvcmRlcicpKSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG59KTtcbm9yZGVyRFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0Q3VzdG9tZXJPcmRlcnNCZXR3ZWVuJywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0Q3VzdG9tZXJPcmRlcnNCZXR3ZWVuJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkoXG4gICAgS2V5Q29uZGl0aW9uLmVxKCdjdXN0b21lcicsICdjdXN0b21lcicpLmFuZChLZXlDb25kaXRpb24uYmV0d2Vlbignb3JkZXInLCAnb3JkZXIxJywgJ29yZGVyMicpKSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG59KTtcbm9yZGVyRFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0T3JkZXJDdXN0b21lcnNGaWx0ZXInLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRPcmRlckN1c3RvbWVyc0ZpbHRlcicsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlF1ZXJ5KFxuICAgIEtleUNvbmRpdGlvbi5lcSgnb3JkZXInLCAnb3JkZXInKS5hbmQoS2V5Q29uZGl0aW9uLmJlZ2luc1dpdGgoJ2N1c3RvbWVyJywgJ2N1c3RvbWVyJykpKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbn0pO1xub3JkZXJEUy5jcmVhdGVSZXNvbHZlcignUXVlcnlHZXRPcmRlckN1c3RvbWVyc0JldHdlZW4nLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRPcmRlckN1c3RvbWVyc0JldHdlZW4nLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJRdWVyeShcbiAgICBLZXlDb25kaXRpb24uZXEoJ29yZGVyJywgJ29yZGVyJykuYW5kKEtleUNvbmRpdGlvbi5iZXR3ZWVuKCdjdXN0b21lcicsICdjdXN0b21lcjEnLCAnY3VzdG9tZXIyJykpLCAnb3JkZXJJbmRleCcpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxufSk7XG5cbnBheW1lbnREUy5jcmVhdGVSZXNvbHZlcignUXVlcnlHZXRQYXltZW50Jywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0UGF5bWVudCcsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYkdldEl0ZW0oJ2lkJywgJ2lkJyksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcbnBheW1lbnREUy5jcmVhdGVSZXNvbHZlcignUXVlcnlHZXRQYXltZW50Q29uc2lzdGVudCcsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldFBheW1lbnRDb25zaXN0ZW50JyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiR2V0SXRlbSgnaWQnLCAnaWQnLCB0cnVlKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdEl0ZW0oKSxcbn0pO1xucGF5bWVudERTLmNyZWF0ZVJlc29sdmVyKCdNdXRhdGlvblNhdmVQYXltZW50Jywge1xuICB0eXBlTmFtZTogJ011dGF0aW9uJyxcbiAgZmllbGROYW1lOiAnc2F2ZVBheW1lbnQnLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJQdXRJdGVtKFByaW1hcnlLZXkucGFydGl0aW9uKCdpZCcpLmF1dG8oKSwgVmFsdWVzLnByb2plY3RpbmcoJ3BheW1lbnQnKSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcblxuY29uc3QgaHR0cERTID0gYXBpLmFkZEh0dHBEYXRhU291cmNlKCdkcycsICdodHRwczovL2F3cy5hbWF6b24uY29tLycsIHsgbmFtZTogJ2h0dHAnIH0pO1xuXG5odHRwRFMuY3JlYXRlUmVzb2x2ZXIoJ011dGF0aW9uRG9Qb3N0T25Bd3MnLCB7XG4gIHR5cGVOYW1lOiAnTXV0YXRpb24nLFxuICBmaWVsZE5hbWU6ICdkb1Bvc3RPbkF3cycsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5mcm9tU3RyaW5nKGB7XG4gICAgXCJ2ZXJzaW9uXCI6IFwiMjAxOC0wNS0yOVwiLFxuICAgIFwibWV0aG9kXCI6IFwiUE9TVFwiLFxuICAgICMgaWYgZnVsbCBwYXRoIGlzIGh0dHBzOi8vYXBpLnh4eHh4eHh4eC5jb20vcG9zdHMgdGhlbiByZXNvdXJjZVBhdGggd291bGQgYmUgL3Bvc3RzXG4gICAgXCJyZXNvdXJjZVBhdGhcIjogXCIvcGF0aC8xMjNcIixcbiAgICBcInBhcmFtc1wiOntcbiAgICAgICAgXCJib2R5XCI6ICR1dGlsLnRvSnNvbigkY3R4LmFyZ3MpLFxuICAgICAgICBcImhlYWRlcnNcIjp7XG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBcIiRjdHgucmVxdWVzdC5oZWFkZXJzLkF1dGhvcml6YXRpb25cIlxuICAgICAgICB9XG4gICAgfVxuICB9YCksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZnJvbVN0cmluZyhgXG4gICAgIyMgUmFpc2UgYSBHcmFwaFFMIGZpZWxkIGVycm9yIGluIGNhc2Ugb2YgYSBkYXRhc291cmNlIGludm9jYXRpb24gZXJyb3JcbiAgICAjaWYoJGN0eC5lcnJvcilcbiAgICAgICR1dGlsLmVycm9yKCRjdHguZXJyb3IubWVzc2FnZSwgJGN0eC5lcnJvci50eXBlKVxuICAgICNlbmRcbiAgICAjIyBpZiB0aGUgcmVzcG9uc2Ugc3RhdHVzIGNvZGUgaXMgbm90IDIwMCwgdGhlbiByZXR1cm4gYW4gZXJyb3IuIEVsc2UgcmV0dXJuIHRoZSBib2R5ICoqXG4gICAgI2lmKCRjdHgucmVzdWx0LnN0YXR1c0NvZGUgPT0gMjAwKVxuICAgICAgICAjIyBJZiByZXNwb25zZSBpcyAyMDAsIHJldHVybiB0aGUgYm9keS5cbiAgICAgICAgJGN0eC5yZXN1bHQuYm9keVxuICAgICNlbHNlXG4gICAgICAgICMjIElmIHJlc3BvbnNlIGlzIG5vdCAyMDAsIGFwcGVuZCB0aGUgcmVzcG9uc2UgdG8gZXJyb3IgYmxvY2suXG4gICAgICAgICR1dGlscy5hcHBlbmRFcnJvcigkY3R4LnJlc3VsdC5ib2R5LCBcIiRjdHgucmVzdWx0LnN0YXR1c0NvZGVcIilcbiAgICAjZW5kXG4gIGApLFxufSk7XG5cbmFwcC5zeW50aCgpO1xuIl19