[
  {
    "Resources": {
      "vpcA2121C38": {
        "Type": "AWS::EC2::VPC",
        "Properties": {
          "CidrBlock": "10.0.0.0/16",
          "EnableDnsHostnames": true,
          "EnableDnsSupport": true,
          "InstanceTenancy": "default",
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc"
            }
          ]
        }
      },
      "vpcPublicSubnet1Subnet2E65531E": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.0.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1a",
          "MapPublicIpOnLaunch": true,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Public"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Public"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet1RouteTable48A2DF9B": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet1RouteTableAssociation5D3F4579": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet1RouteTable48A2DF9B"
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet1Subnet2E65531E"
          }
        }
      },
      "vpcPublicSubnet1DefaultRoute10708846": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet1RouteTable48A2DF9B"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "GatewayId": {
            "Ref": "vpcIGWE57CBDCA"
          }
        },
        "DependsOn": [
          "vpcVPCGW7984C166"
        ]
      },
      "vpcPublicSubnet1EIPDA49DCBE": {
        "Type": "AWS::EC2::EIP",
        "Properties": {
          "Domain": "vpc",
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet1NATGateway9C16659E": {
        "Type": "AWS::EC2::NatGateway",
        "Properties": {
          "AllocationId": {
            "Fn::GetAtt": [
              "vpcPublicSubnet1EIPDA49DCBE",
              "AllocationId"
            ]
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet1Subnet2E65531E"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2Subnet009B674F": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.64.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1b",
          "MapPublicIpOnLaunch": true,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Public"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Public"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2RouteTableEB40D4CB": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2RouteTableAssociation21F81B59": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet2RouteTableEB40D4CB"
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet2Subnet009B674F"
          }
        }
      },
      "vpcPublicSubnet2DefaultRouteA1EC0F60": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet2RouteTableEB40D4CB"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "GatewayId": {
            "Ref": "vpcIGWE57CBDCA"
          }
        },
        "DependsOn": [
          "vpcVPCGW7984C166"
        ]
      },
      "vpcPublicSubnet2EIP9B3743B1": {
        "Type": "AWS::EC2::EIP",
        "Properties": {
          "Domain": "vpc",
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2NATGateway9B8AE11A": {
        "Type": "AWS::EC2::NatGateway",
        "Properties": {
          "AllocationId": {
            "Fn::GetAtt": [
              "vpcPublicSubnet2EIP9B3743B1",
              "AllocationId"
            ]
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet2Subnet009B674F"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet1Subnet934893E8": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.128.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1a",
          "MapPublicIpOnLaunch": false,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet1"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Private"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Private"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet1RouteTableB41A48CC": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet1"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet1RouteTableAssociation67945127": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet1RouteTableB41A48CC"
          },
          "SubnetId": {
            "Ref": "vpcPrivateSubnet1Subnet934893E8"
          }
        }
      },
      "vpcPrivateSubnet1DefaultRoute1AA8E2E5": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet1RouteTableB41A48CC"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "NatGatewayId": {
            "Ref": "vpcPublicSubnet1NATGateway9C16659E"
          }
        }
      },
      "vpcPrivateSubnet2Subnet7031C2BA": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.192.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1b",
          "MapPublicIpOnLaunch": false,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet2"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Private"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Private"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet2RouteTable7280F23E": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet2"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet2RouteTableAssociation007E94D3": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet2RouteTable7280F23E"
          },
          "SubnetId": {
            "Ref": "vpcPrivateSubnet2Subnet7031C2BA"
          }
        }
      },
      "vpcPrivateSubnet2DefaultRouteB0E07F99": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet2RouteTable7280F23E"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "NatGatewayId": {
            "Ref": "vpcPublicSubnet2NATGateway9B8AE11A"
          }
        }
      },
      "vpcIGWE57CBDCA": {
        "Type": "AWS::EC2::InternetGateway",
        "Properties": {
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc"
            }
          ]
        }
      },
      "vpcVPCGW7984C166": {
        "Type": "AWS::EC2::VPCGatewayAttachment",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "InternetGatewayId": {
            "Ref": "vpcIGWE57CBDCA"
          }
        }
      }
    },
    "Outputs": {
      "ExportsOutputRefvpcA2121C384D1B3CDE": {
        "Value": {
          "Ref": "vpcA2121C38"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcA2121C384D1B3CDE"
        }
      },
      "ExportsOutputRefvpcPublicSubnet1Subnet2E65531ECCB85041": {
        "Value": {
          "Ref": "vpcPublicSubnet1Subnet2E65531E"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPublicSubnet1Subnet2E65531ECCB85041"
        }
      },
      "ExportsOutputRefvpcPublicSubnet2Subnet009B674FB900C242": {
        "Value": {
          "Ref": "vpcPublicSubnet2Subnet009B674F"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPublicSubnet2Subnet009B674FB900C242"
        }
      },
      "ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271": {
        "Value": {
          "Ref": "vpcPrivateSubnet1Subnet934893E8"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271"
        }
      },
      "ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE": {
        "Value": {
          "Ref": "vpcPrivateSubnet2Subnet7031C2BA"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE"
        }
      }
    }
  },
  {
    "Resources": {
      "cluster22Role6F752780": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "Service": "eks.amazonaws.com"
                }
              }
            ],
            "Version": "2012-10-17"
          },
          "ManagedPolicyArns": [
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKSClusterPolicy"
                ]
              ]
            },
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKSServicePolicy"
                ]
              ]
            }
          ]
        }
      },
      "cluster22ControlPlaneSecurityGroup2648B9CD": {
        "Type": "AWS::EC2::SecurityGroup",
        "Properties": {
          "GroupDescription": "EKS Control Plane Security Group",
          "SecurityGroupEgress": [
            {
              "CidrIp": "0.0.0.0/0",
              "Description": "Allow all outbound traffic by default",
              "IpProtocol": "-1"
            }
          ],
          "VpcId": {
            "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcA2121C384D1B3CDE"
          }
        }
      },
      "cluster22ControlPlaneSecurityGroupfromk8sclustercluster22NodesInstanceSecurityGroupF903AE86443C3EDA943": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "tcp",
          "Description": "from k8sclustercluster22NodesInstanceSecurityGroupF903AE86:443",
          "FromPort": 443,
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22ControlPlaneSecurityGroup2648B9CD",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "ToPort": 443
        }
      },
      "cluster22CreationRole8343FFAB": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "AWS": [
                    {
                      "Fn::GetAtt": [
                        "awscdkawseksClusterResourceProviderNestedStackawscdkawseksClusterResourceProviderNestedStackResource9827C454",
                        "Outputs.k8sclusterawscdkawseksClusterResourceProviderOnEventHandlerServiceRoleB0E0C79CArn"
                      ]
                    },
                    {
                      "Fn::GetAtt": [
                        "awscdkawseksClusterResourceProviderNestedStackawscdkawseksClusterResourceProviderNestedStackResource9827C454",
                        "Outputs.k8sclusterawscdkawseksClusterResourceProviderIsCompleteHandlerServiceRole47C757F4Arn"
                      ]
                    }
                  ]
                }
              },
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "AWS": {
                    "Fn::GetAtt": [
                      "awscdkawseksKubectlProviderNestedStackawscdkawseksKubectlProviderNestedStackResourceA7AEBA6B",
                      "Outputs.k8sclusterawscdkawseksKubectlProviderHandlerServiceRole86663150Arn"
                    ]
                  }
                }
              }
            ],
            "Version": "2012-10-17"
          }
        }
      },
      "cluster22CreationRoleDefaultPolicy0015FEEF": {
        "Type": "AWS::IAM::Policy",
        "Properties": {
          "PolicyDocument": {
            "Statement": [
              {
                "Action": "iam:PassRole",
                "Effect": "Allow",
                "Resource": {
                  "Fn::GetAtt": [
                    "cluster22Role6F752780",
                    "Arn"
                  ]
                }
              },
              {
                "Action": [
                  "eks:CreateCluster",
                  "eks:DescribeCluster",
                  "eks:DeleteCluster",
                  "eks:UpdateClusterVersion",
                  "eks:UpdateClusterConfig",
                  "eks:CreateFargateProfile"
                ],
                "Effect": "Allow",
                "Resource": "*"
              },
              {
                "Action": [
                  "eks:DescribeFargateProfile",
                  "eks:DeleteFargateProfile"
                ],
                "Effect": "Allow",
                "Resource": "*"
              },
              {
                "Action": "iam:GetRole",
                "Effect": "Allow",
                "Resource": "*"
              },
              {
                "Action": "iam:CreateServiceLinkedRole",
                "Effect": "Allow",
                "Resource": "*"
              }
            ],
            "Version": "2012-10-17"
          },
          "PolicyName": "cluster22CreationRoleDefaultPolicy0015FEEF",
          "Roles": [
            {
              "Ref": "cluster22CreationRole8343FFAB"
            }
          ]
        }
      },
      "cluster227BD1CB20": {
        "Type": "Custom::AWSCDK-EKS-Cluster",
        "Properties": {
          "ServiceToken": {
            "Fn::GetAtt": [
              "awscdkawseksClusterResourceProviderNestedStackawscdkawseksClusterResourceProviderNestedStackResource9827C454",
              "Outputs.k8sclusterawscdkawseksClusterResourceProviderframeworkonEventF31E5604Arn"
            ]
          },
          "Config": {
            "roleArn": {
              "Fn::GetAtt": [
                "cluster22Role6F752780",
                "Arn"
              ]
            },
            "resourcesVpcConfig": {
              "securityGroupIds": [
                {
                  "Fn::GetAtt": [
                    "cluster22ControlPlaneSecurityGroup2648B9CD",
                    "GroupId"
                  ]
                }
              ],
              "subnetIds": [
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPublicSubnet1Subnet2E65531ECCB85041"
                },
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPublicSubnet2Subnet009B674FB900C242"
                },
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271"
                },
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE"
                }
              ]
            }
          },
          "AssumeRoleArn": {
            "Fn::GetAtt": [
              "cluster22CreationRole8343FFAB",
              "Arn"
            ]
          }
        },
        "DependsOn": [
          "cluster22CreationRoleDefaultPolicy0015FEEF",
          "cluster22CreationRole8343FFAB"
        ],
        "UpdateReplacePolicy": "Delete",
        "DeletionPolicy": "Delete"
      },
      "cluster22AwsAuthmanifest4685C84D": {
        "Type": "Custom::AWSCDK-EKS-KubernetesResource",
        "Properties": {
          "ServiceToken": {
            "Fn::GetAtt": [
              "awscdkawseksKubectlProviderNestedStackawscdkawseksKubectlProviderNestedStackResourceA7AEBA6B",
              "Outputs.k8sclusterawscdkawseksKubectlProviderframeworkonEvent99400C2DArn"
            ]
          },
          "Manifest": {
            "Fn::Join": [
              "",
              [
                "[{\"apiVersion\":\"v1\",\"kind\":\"ConfigMap\",\"metadata\":{\"name\":\"aws-auth\",\"namespace\":\"kube-system\"},\"data\":{\"mapRoles\":\"[{\\\"rolearn\\\":\\\"",
                {
                  "Fn::GetAtt": [
                    "AdminRole38563C57",
                    "Arn"
                  ]
                },
                "\\\",\\\"username\\\":\\\"",
                {
                  "Fn::GetAtt": [
                    "AdminRole38563C57",
                    "Arn"
                  ]
                },
                "\\\",\\\"groups\\\":[\\\"system:masters\\\"]},{\\\"rolearn\\\":\\\"",
                {
                  "Fn::GetAtt": [
                    "cluster22NodesInstanceRole51CD052F",
                    "Arn"
                  ]
                },
                "\\\",\\\"username\\\":\\\"system:node:{{EC2PrivateDNSName}}\\\",\\\"groups\\\":[\\\"system:bootstrappers\\\",\\\"system:nodes\\\"]}]\",\"mapUsers\":\"[]\",\"mapAccounts\":\"[]\"}}]"
              ]
            ]
          },
          "ClusterName": {
            "Ref": "cluster227BD1CB20"
          },
          "RoleArn": {
            "Fn::GetAtt": [
              "cluster22CreationRole8343FFAB",
              "Arn"
            ]
          }
        },
        "UpdateReplacePolicy": "Delete",
        "DeletionPolicy": "Delete"
      },
      "cluster22NodesInstanceSecurityGroup4A3CDC24": {
        "Type": "AWS::EC2::SecurityGroup",
        "Properties": {
          "GroupDescription": "k8s-cluster/cluster22/Nodes/InstanceSecurityGroup",
          "SecurityGroupEgress": [
            {
              "CidrIp": "0.0.0.0/0",
              "Description": "Allow all outbound traffic by default",
              "IpProtocol": "-1"
            }
          ],
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-cluster/cluster22/Nodes"
            },
            {
              "Key": {
                "Fn::Join": [
                  "",
                  [
                    "kubernetes.io/cluster/",
                    {
                      "Ref": "cluster227BD1CB20"
                    }
                  ]
                ]
              },
              "Value": "owned"
            }
          ],
          "VpcId": {
            "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcA2121C384D1B3CDE"
          }
        }
      },
      "cluster22NodesInstanceSecurityGroupfromk8sclustercluster22NodesInstanceSecurityGroupF903AE86ALLTRAFFIC774C7781": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "-1",
          "Description": "from k8sclustercluster22NodesInstanceSecurityGroupF903AE86:ALL TRAFFIC",
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          }
        }
      },
      "cluster22NodesInstanceSecurityGroupfromk8sclustercluster22ControlPlaneSecurityGroup3B5F21B44434A6E344D": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "tcp",
          "Description": "from k8sclustercluster22ControlPlaneSecurityGroup3B5F21B4:443",
          "FromPort": 443,
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22ControlPlaneSecurityGroup2648B9CD",
              "GroupId"
            ]
          },
          "ToPort": 443
        }
      },
      "cluster22NodesInstanceSecurityGroupfromk8sclustercluster22ControlPlaneSecurityGroup3B5F21B41025655355658FCAA": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "tcp",
          "Description": "from k8sclustercluster22ControlPlaneSecurityGroup3B5F21B4:1025-65535",
          "FromPort": 1025,
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22ControlPlaneSecurityGroup2648B9CD",
              "GroupId"
            ]
          },
          "ToPort": 65535
        }
      },
      "cluster22NodesInstanceRole51CD052F": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "Service": {
                    "Fn::Join": [
                      "",
                      [
                        "ec2.",
                        {
                          "Ref": "AWS::URLSuffix"
                        }
                      ]
                    ]
                  }
                }
              }
            ],
            "Version": "2012-10-17"
          },
          "ManagedPolicyArns": [
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKSWorkerNodePolicy"
                ]
              ]
            },
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKS_CNI_Policy"
                ]
              ]
            },
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEC2ContainerRegistryReadOnly"
                ]
              ]
            }
          ],
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-cluster/cluster22/Nodes"
            },
            {
              "Key": {
                "Fn::Join": [
                  "",
                  [
                    "kubernetes.io/cluster/",
                    {
                      "Ref": "cluster227BD1CB20"
                    }
                  ]
                ]
              },
              "Value": "owned"
            }
          ]
        }
      },
      "cluster22NodesInstanceProfile3D4963ED": {
        "Type": "AWS::IAM::InstanceProfile",
        "Properties": {
          "Roles": [
            {
              "Ref": "cluster22NodesInstanceRole51CD052F"
            }
          ]
        }
      },
      "cluster22NodesLaunchConfig184BF3BA": {
        "Type": "AWS::AutoScaling::LaunchConfiguration",
        "Properties": {
          "ImageId": {
            "Ref": "SsmParameterValueawsserviceeksoptimizedami114amazonlinux2recommendedimageidC96584B6F00A464EAD1953AFF4B05118Parameter"
          },
          "InstanceType": "t2.medium",
          "IamInstanceProfile": {
            "Ref": "cluster22NodesInstanceProfile3D4963ED"
          },
          "SecurityGroups": [
            {
              "Fn::GetAtt": [
                "cluster22NodesInstanceSecurityGroup4A3CDC24",
                "GroupId"
              ]
            }
          ],
          "UserData": {
            "Fn::Base64": {
              "Fn::Join": [
                "",
                [
                  "#!/bin/bash\nset -o xtrace\n/etc/eks/bootstrap.sh ",
                  {
                    "Ref": "cluster227BD1CB20"
                  },
                  " --kubelet-extra-args \"--node-labels lifecycle=OnDemand\" --use-max-pods true\n/opt/aws/bin/cfn-signal --exit-code $? --stack k8s-cluster --resource cluster22NodesASGC0A97398 --region test-region"
                ]
              ]
            }
          }
        },
        "DependsOn": [
          "cluster22NodesInstanceRole51CD052F"
        ]
      },
      "cluster22NodesASGC0A97398": {
        "Type": "AWS::AutoScaling::AutoScalingGroup",
        "Properties": {
          "MaxSize": "3",
          "MinSize": "3",
          "LaunchConfigurationName": {
            "Ref": "cluster22NodesLaunchConfig184BF3BA"
          },
          "Tags": [
            {
              "Key": "Name",
              "PropagateAtLaunch": true,
              "Value": "k8s-cluster/cluster22/Nodes"
            },
            {
              "Key": {
                "Fn::Join": [
                  "",
                  [
                    "kubernetes.io/cluster/",
                    {
                      "Ref": "cluster227BD1CB20"
                    }
                  ]
                ]
              },
              "PropagateAtLaunch": true,
              "Value": "owned"
            }
          ],
          "VPCZoneIdentifier": [
            {
              "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271"
            },
            {
              "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE"
            }
          ]
        },
        "UpdatePolicy": {
          "AutoScalingRollingUpdate": {
            "WaitOnResourceSignals": false,
            "PauseTime": "PT0S",
            "SuspendProcesses": [
              "HealthCheck",
              "ReplaceUnhealthy",
              "AZRebalance",
              "AlarmNotification",
              "ScheduledActions"
            ]
          },
          "AutoScalingScheduledAction": {
            "IgnoreUnmodifiedGroupSizeProperties": true
          }
        }
      },
      "cluster22manifesthellokubernetes849F52EA": {
        "Type": "Custom::AWSCDK-EKS-KubernetesResource",
        "Properties": {
          "ServiceToken": {
            "Fn::GetAtt": [
              "awscdkawseksKubectlProviderNestedStackawscdkawseksKubectlProviderNestedStackResourceA7AEBA6B",
              "Outputs.k8sclusterawscdkawseksKubectlProviderframeworkonEvent99400C2DArn"
            ]
          },
          "Manifest": "[{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"name\":\"hello-kubernetes\"},\"spec\":{\"type\":\"LoadBalancer\",\"ports\":[{\"port\":80,\"targetPort\":8080}],\"selector\":{\"app\":\"hello-kubernetes\"}}},{\"apiVersion\":\"apps/v1\",\"kind\":\"Deployment\",\"metadata\":{\"name\":\"hello-kubernetes\"},\"spec\":{\"replicas\":1,\"selector\":{\"matchLabels\":{\"app\":\"hello-kubernetes\"}},\"template\":{\"metadata\":{\"labels\":{\"app\":\"hello-kubernetes\"}},\"spec\":{\"containers\":[{\"name\":\"hello-kubernetes\",\"image\":\"paulbouwer/hello-kubernetes:1.5\",\"ports\":[{\"containerPort\":8080}]}]}}}}]",
          "ClusterName": {
            "Ref": "cluster227BD1CB20"
          },
          "RoleArn": {
            "Fn::GetAtt": [
              "cluster22CreationRole8343FFAB",
              "Arn"
            ]
          }
        },
        "UpdateReplacePolicy": "Delete",
        "DeletionPolicy": "Delete"
      },
      "awscdkawseksClusterResourceProviderNestedStackawscdkawseksClusterResourceProviderNestedStackResource9827C454": {
        "Type": "AWS::CloudFormation::Stack",
        "Properties": {
          "TemplateURL": {
            "Fn::Join": [
              "",
              [
                "https://s3.test-region.",
                {
                  "Ref": "AWS::URLSuffix"
                },
                "/",
                {
                  "Ref": "AssetParametersfdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2S3BucketC7079F0F"
                },
                "/",
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersfdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2S3VersionKey343815BD"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersfdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2S3VersionKey343815BD"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          },
          "Parameters": {
            "referencetok8sclusterAssetParameters52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843S3BucketCB2FD604Ref": {
              "Ref": "AssetParameters52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843S3BucketB1B98CB7"
            },
            "referencetok8sclusterAssetParameters52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843S3VersionKey74721DDBRef": {
              "Ref": "AssetParameters52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843S3VersionKey3E52B70E"
            },
            "referencetok8sclusterAssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3BucketAC1E446FRef": {
              "Ref": "AssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3Bucket75CDEB48"
            },
            "referencetok8sclusterAssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3VersionKey2740EA54Ref": {
              "Ref": "AssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3VersionKey1DD5E19F"
            }
          }
        }
      },
      "AdminRole38563C57": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "AWS": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition"
                        },
                        ":iam::12345678:root"
                      ]
                    ]
                  }
                }
              }
            ],
            "Version": "2012-10-17"
          }
        }
      },
      "awscdkawseksKubectlProviderNestedStackawscdkawseksKubectlProviderNestedStackResourceA7AEBA6B": {
        "Type": "AWS::CloudFormation::Stack",
        "Properties": {
          "TemplateURL": {
            "Fn::Join": [
              "",
              [
                "https://s3.test-region.",
                {
                  "Ref": "AWS::URLSuffix"
                },
                "/",
                {
                  "Ref": "AssetParameters9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043S3BucketFF267E5C"
                },
                "/",
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043S3VersionKey6B380305"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043S3VersionKey6B380305"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          },
          "Parameters": {
            "referencetok8sclusterAssetParametersb9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05S3Bucket2E8FCB81Ref": {
              "Ref": "AssetParametersb9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05S3Bucket43C417FC"
            },
            "referencetok8sclusterAssetParametersb9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05S3VersionKey79361ED0Ref": {
              "Ref": "AssetParametersb9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05S3VersionKey20A1F28B"
            },
            "referencetok8sclusterAssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3BucketAC1E446FRef": {
              "Ref": "AssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3Bucket75CDEB48"
            },
            "referencetok8sclusterAssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3VersionKey2740EA54Ref": {
              "Ref": "AssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3VersionKey1DD5E19F"
            }
          }
        }
      }
    },
    "Outputs": {
      "cluster22ConfigCommand96B20279": {
        "Value": {
          "Fn::Join": [
            "",
            [
              "aws eks update-kubeconfig --name ",
              {
                "Ref": "cluster227BD1CB20"
              },
              " --region test-region"
            ]
          ]
        }
      },
      "cluster22GetTokenCommand99DB9B02": {
        "Value": {
          "Fn::Join": [
            "",
            [
              "aws eks get-token --cluster-name ",
              {
                "Ref": "cluster227BD1CB20"
              },
              " --region test-region"
            ]
          ]
        }
      }
    },
    "Parameters": {
      "AssetParameters52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843S3BucketB1B98CB7": {
        "Type": "String",
        "Description": "S3 bucket for asset \"52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843\""
      },
      "AssetParameters52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843S3VersionKey3E52B70E": {
        "Type": "String",
        "Description": "S3 key for asset version \"52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843\""
      },
      "AssetParameters52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843ArtifactHashBB23B423": {
        "Type": "String",
        "Description": "Artifact hash for asset \"52b3b8ab304639fa78abb311c605789b1593cf287bfe0d52aafa2821a11c5843\""
      },
      "AssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3Bucket75CDEB48": {
        "Type": "String",
        "Description": "S3 bucket for asset \"6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044\""
      },
      "AssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044S3VersionKey1DD5E19F": {
        "Type": "String",
        "Description": "S3 key for asset version \"6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044\""
      },
      "AssetParameters6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044ArtifactHashF11F33A4": {
        "Type": "String",
        "Description": "Artifact hash for asset \"6c3e21f76e4ba0bc4b901f71bfa9c1eaf7929edcfd9a1591690d12b024100044\""
      },
      "AssetParametersb9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05S3Bucket43C417FC": {
        "Type": "String",
        "Description": "S3 bucket for asset \"b9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05\""
      },
      "AssetParametersb9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05S3VersionKey20A1F28B": {
        "Type": "String",
        "Description": "S3 key for asset version \"b9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05\""
      },
      "AssetParametersb9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05ArtifactHashA974FA77": {
        "Type": "String",
        "Description": "Artifact hash for asset \"b9fea7a2c33af6e6a973473a7d3ad91a281804669cb7ab44663498a1e32cfe05\""
      },
      "AssetParameters9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043S3BucketFF267E5C": {
        "Type": "String",
        "Description": "S3 bucket for asset \"9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043\""
      },
      "AssetParameters9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043S3VersionKey6B380305": {
        "Type": "String",
        "Description": "S3 key for asset version \"9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043\""
      },
      "AssetParameters9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043ArtifactHash829FAF2D": {
        "Type": "String",
        "Description": "Artifact hash for asset \"9a70afed3482223a5e6b0f157841fe60e4d62345712d75e532619626b9488043\""
      },
      "AssetParametersfdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2S3BucketC7079F0F": {
        "Type": "String",
        "Description": "S3 bucket for asset \"fdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2\""
      },
      "AssetParametersfdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2S3VersionKey343815BD": {
        "Type": "String",
        "Description": "S3 key for asset version \"fdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2\""
      },
      "AssetParametersfdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2ArtifactHashEDE1C61F": {
        "Type": "String",
        "Description": "Artifact hash for asset \"fdc905ecbc3f530037fdffcd0747d626ac7f327c391ecdaddd56b11c1be17fd2\""
      },
      "SsmParameterValueawsserviceeksoptimizedami114amazonlinux2recommendedimageidC96584B6F00A464EAD1953AFF4B05118Parameter": {
        "Type": "AWS::SSM::Parameter::Value<String>",
        "Default": "/aws/service/eks/optimized-ami/1.14/amazon-linux-2/recommended/image_id"
      }
    }
  }
]