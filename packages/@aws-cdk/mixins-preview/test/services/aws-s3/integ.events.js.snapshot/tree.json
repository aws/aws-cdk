{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"0.0.0"},"children":{"L1L2BucketWithL2Rule":{"id":"L1L2BucketWithL2Rule","path":"L1L2BucketWithL2Rule","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"bucket":{"id":"bucket","path":"L1L2BucketWithL2Rule/bucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}},"bucketL2":{"id":"bucketL2","path":"L1L2BucketWithL2Rule/bucketL2","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/bucketL2/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}}}},"MyFuncA":{"id":"MyFuncA","path":"L1L2BucketWithL2Rule/MyFuncA","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"0.0.0","metadata":[{"runtime":"*","handler":"*","code":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"L1L2BucketWithL2Rule/MyFuncA/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"L1L2BucketWithL2Rule/MyFuncA/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/MyFuncA/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/MyFuncA/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nexports.handler = async (event) => {\n  console.log(\"New Project event:\", JSON.stringify(event, null, 2));\n  return {};\n};\n"},"handler":"index.handler","role":{"Fn::GetAtt":["MyFuncAServiceRole9A674AAA","Arn"]},"runtime":"nodejs22.x"}}},"LogGroup":{"id":"LogGroup","path":"L1L2BucketWithL2Rule/MyFuncA/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"0.0.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/MyFuncA/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"MyFuncAAF5F3089"}]]},"retentionInDays":731}}}}}}},"Trail":{"id":"Trail","path":"L1L2BucketWithL2Rule/Trail","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.Trail","version":"0.0.0","metadata":["*",{"addS3EventSelector":[[{"bucket":"*"}],{"readWriteType":"All"}]},{"addEventSelector":["AWS::S3::Object",["*"],{"readWriteType":"All"}]},{"addS3EventSelector":[[{"bucket":"*"}],{"readWriteType":"All"}]},{"addEventSelector":["AWS::S3::Object",["*"],{"readWriteType":"All"}]}]},"children":{"S3":{"id":"S3","path":"L1L2BucketWithL2Rule/Trail/S3","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0","metadata":[{"enforceSSL":true}]},"children":{"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/Trail/S3/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}},"Policy":{"id":"Policy","path":"L1L2BucketWithL2Rule/Trail/S3/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"0.0.0","metadata":[{"bucket":"*"}]},"children":{"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/Trail/S3/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"TrailS30071F172"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["TrailS30071F172","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/*"]]}]},{"Action":"s3:GetBucketAcl","Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::GetAtt":["TrailS30071F172","Arn"]}},{"Action":"s3:PutObject","Condition":{"StringEquals":{"s3:x-amz-acl":"bucket-owner-full-control"}},"Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/AWSLogs/",{"Ref":"AWS::AccountId"},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/Trail/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.CfnTrail","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudTrail::Trail","aws:cdk:cloudformation:props":{"enableLogFileValidation":true,"eventSelectors":[{"dataResources":[{"type":"AWS::S3::Object","values":[{"Fn::Join":["",[{"Fn::GetAtt":["bucket","Arn"]},"/"]]}]}],"readWriteType":"All"},{"dataResources":[{"type":"AWS::S3::Object","values":[{"Fn::Join":["",[{"Fn::GetAtt":["bucketL2297FC72A","Arn"]},"/"]]}]}],"readWriteType":"All"}],"includeGlobalServiceEvents":true,"isLogging":true,"isMultiRegionTrail":true,"s3BucketName":{"Ref":"TrailS30071F172"}}}}}},"L2RuleForL1":{"id":"L2RuleForL1","path":"L1L2BucketWithL2Rule/L2RuleForL1","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"targets":"*"},{"addEventPattern":["*"]},{"addTarget":[{}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]}]},"children":{"Resource":{"id":"Resource","path":"L1L2BucketWithL2Rule/L2RuleForL1/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"eventPattern":{"source":["aws.s3"],"detail-type":["AWS API Call via CloudTrail"],"detail":{"requestParameters":{"bucketName":[{"Ref":"bucket"},{"Ref":"bucketL2297FC72A"}]},"tlsDetails":{"tlsVersion":["TLSv1.3"]}},"region":["us-east-1"]},"state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]}}]}}},"AllowEventRuleL1L2BucketWithL2RuleMyFuncAE7084B38":{"id":"AllowEventRuleL1L2BucketWithL2RuleMyFuncAE7084B38","path":"L1L2BucketWithL2Rule/L2RuleForL1/AllowEventRuleL1L2BucketWithL2RuleMyFuncAE7084B38","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["L2RuleForL13AA6354B","Arn"]}}}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"L1L2BucketWithL2Rule/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"L1L2BucketWithL2Rule/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"L1BucketWithL1Rule":{"id":"L1BucketWithL1Rule","path":"L1BucketWithL1Rule","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"bucket":{"id":"bucket","path":"L1BucketWithL1Rule/bucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}},"Trail":{"id":"Trail","path":"L1BucketWithL1Rule/Trail","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.Trail","version":"0.0.0","metadata":["*",{"addS3EventSelector":[[{"bucket":"*"}],{"readWriteType":"All"}]},{"addEventSelector":["AWS::S3::Object",["*"],{"readWriteType":"All"}]}]},"children":{"S3":{"id":"S3","path":"L1BucketWithL1Rule/Trail/S3","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0","metadata":[{"enforceSSL":true}]},"children":{"Resource":{"id":"Resource","path":"L1BucketWithL1Rule/Trail/S3/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}},"Policy":{"id":"Policy","path":"L1BucketWithL1Rule/Trail/S3/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"0.0.0","metadata":[{"bucket":"*"}]},"children":{"Resource":{"id":"Resource","path":"L1BucketWithL1Rule/Trail/S3/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"TrailS30071F172"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["TrailS30071F172","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/*"]]}]},{"Action":"s3:GetBucketAcl","Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::GetAtt":["TrailS30071F172","Arn"]}},{"Action":"s3:PutObject","Condition":{"StringEquals":{"s3:x-amz-acl":"bucket-owner-full-control"}},"Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/AWSLogs/",{"Ref":"AWS::AccountId"},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"Resource":{"id":"Resource","path":"L1BucketWithL1Rule/Trail/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.CfnTrail","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudTrail::Trail","aws:cdk:cloudformation:props":{"enableLogFileValidation":true,"eventSelectors":[{"dataResources":[{"type":"AWS::S3::Object","values":[{"Fn::Join":["",[{"Fn::GetAtt":["bucket","Arn"]},"/"]]}]}],"readWriteType":"All"}],"includeGlobalServiceEvents":true,"isLogging":true,"isMultiRegionTrail":true,"s3BucketName":{"Ref":"TrailS30071F172"}}}}}},"MyFuncB":{"id":"MyFuncB","path":"L1BucketWithL1Rule/MyFuncB","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"0.0.0","metadata":[{"runtime":"*","handler":"*","code":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"L1BucketWithL1Rule/MyFuncB/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"L1BucketWithL1Rule/MyFuncB/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"L1BucketWithL1Rule/MyFuncB/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"L1BucketWithL1Rule/MyFuncB/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nexports.handler = async (event) => {\n  console.log(\"New Project event:\", JSON.stringify(event, null, 2));\n  return {};\n};\n"},"handler":"index.handler","role":{"Fn::GetAtt":["MyFuncBServiceRole2DC0511D","Arn"]},"runtime":"nodejs22.x"}}},"LogGroup":{"id":"LogGroup","path":"L1BucketWithL1Rule/MyFuncB/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"0.0.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"L1BucketWithL1Rule/MyFuncB/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"MyFuncB694FF518"}]]},"retentionInDays":731}}}}},"L1":{"id":"L1","path":"L1BucketWithL1Rule/MyFuncB/L1","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["MyFuncB694FF518","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["RuleL1BucketL1","Arn"]}}}}}},"RuleL1BucketL1":{"id":"RuleL1BucketL1","path":"L1BucketWithL1Rule/RuleL1BucketL1","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"eventPattern":{"source":["aws.s3"],"detailType":["AWS API Call via CloudTrail"],"detail":{"requestParameters":{"bucketName":[{"Ref":"bucket"}]}}},"state":"ENABLED","targets":[{"arn":{"Fn::GetAtt":["MyFuncB694FF518","Arn"]},"id":"L1"}]}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"L1BucketWithL1Rule/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"L1BucketWithL1Rule/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"L2BucketWithL1Rule":{"id":"L2BucketWithL1Rule","path":"L2BucketWithL1Rule","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"bucketL2":{"id":"bucketL2","path":"L2BucketWithL1Rule/bucketL2","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"L2BucketWithL1Rule/bucketL2/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}}}},"Trail":{"id":"Trail","path":"L2BucketWithL1Rule/Trail","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.Trail","version":"0.0.0","metadata":["*",{"addS3EventSelector":[[{"bucket":"*"}],{"readWriteType":"All"}]},{"addEventSelector":["AWS::S3::Object",["*"],{"readWriteType":"All"}]}]},"children":{"S3":{"id":"S3","path":"L2BucketWithL1Rule/Trail/S3","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0","metadata":[{"enforceSSL":true}]},"children":{"Resource":{"id":"Resource","path":"L2BucketWithL1Rule/Trail/S3/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}},"Policy":{"id":"Policy","path":"L2BucketWithL1Rule/Trail/S3/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"0.0.0","metadata":[{"bucket":"*"}]},"children":{"Resource":{"id":"Resource","path":"L2BucketWithL1Rule/Trail/S3/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"TrailS30071F172"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["TrailS30071F172","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/*"]]}]},{"Action":"s3:GetBucketAcl","Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::GetAtt":["TrailS30071F172","Arn"]}},{"Action":"s3:PutObject","Condition":{"StringEquals":{"s3:x-amz-acl":"bucket-owner-full-control"}},"Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/AWSLogs/",{"Ref":"AWS::AccountId"},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"Resource":{"id":"Resource","path":"L2BucketWithL1Rule/Trail/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.CfnTrail","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudTrail::Trail","aws:cdk:cloudformation:props":{"enableLogFileValidation":true,"eventSelectors":[{"dataResources":[{"type":"AWS::S3::Object","values":[{"Fn::Join":["",[{"Fn::GetAtt":["bucketL2297FC72A","Arn"]},"/"]]}]}],"readWriteType":"All"}],"includeGlobalServiceEvents":true,"isLogging":true,"isMultiRegionTrail":true,"s3BucketName":{"Ref":"TrailS30071F172"}}}}}},"MyFuncC":{"id":"MyFuncC","path":"L2BucketWithL1Rule/MyFuncC","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"0.0.0","metadata":[{"runtime":"*","handler":"*","code":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"L2BucketWithL1Rule/MyFuncC/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"L2BucketWithL1Rule/MyFuncC/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"L2BucketWithL1Rule/MyFuncC/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"L2BucketWithL1Rule/MyFuncC/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nexports.handler = async (event) => {\n  console.log(\"New Project event:\", JSON.stringify(event, null, 2));\n  return {};\n};\n"},"handler":"index.handler","role":{"Fn::GetAtt":["MyFuncCServiceRoleAE8313A3","Arn"]},"runtime":"nodejs22.x"}}},"LogGroup":{"id":"LogGroup","path":"L2BucketWithL1Rule/MyFuncC/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"0.0.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"L2BucketWithL1Rule/MyFuncC/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"MyFuncCF4F4B34F"}]]},"retentionInDays":731}}}}},"L2":{"id":"L2","path":"L2BucketWithL1Rule/MyFuncC/L2","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["MyFuncCF4F4B34F","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["RuleL1BucketL2","Arn"]}}}}}},"RuleL1BucketL2":{"id":"RuleL1BucketL2","path":"L2BucketWithL1Rule/RuleL1BucketL2","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"eventPattern":{"source":["aws.s3"],"detailType":["AWS API Call via CloudTrail"],"detail":{"requestParameters":{"bucketName":[{"Ref":"bucketL2297FC72A"}]}}},"state":"ENABLED","targets":[{"arn":{"Fn::GetAtt":["MyFuncCF4F4B34F","Arn"]},"id":"L2"}]}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"L2BucketWithL1Rule/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"L2BucketWithL1Rule/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"L2BucketOtherEventsWithL2Rule":{"id":"L2BucketOtherEventsWithL2Rule","path":"L2BucketOtherEventsWithL2Rule","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"bucketL2":{"id":"bucketL2","path":"L2BucketOtherEventsWithL2Rule/bucketL2","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0","metadata":[{"eventBridgeEnabled":true}]},"children":{"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/bucketL2/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}},"Notifications":{"id":"Notifications","path":"L2BucketOtherEventsWithL2Rule/bucketL2/Notifications","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/bucketL2/Notifications/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"0.0.0"}}}}}},"BucketNotificationsHandler050a0587b7544547bf325f094a3db834":{"id":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834","path":"L2BucketOtherEventsWithL2Rule/BucketNotificationsHandler050a0587b7544547bf325f094a3db834","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Role":{"id":"Role","path":"L2BucketOtherEventsWithL2Rule/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportRole":{"id":"ImportRole","path":"L2BucketOtherEventsWithL2Rule/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"L2BucketOtherEventsWithL2Rule/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"0.0.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:PutBucketNotification","Effect":"Allow","Resource":{"Fn::GetAtt":["bucketL2297FC72A","Arn"]}}],"Version":"2012-10-17"},"policyName":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36","roles":[{"Ref":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"}]}}}}}}},"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"0.0.0"}}}},"MyFuncA":{"id":"MyFuncA","path":"L2BucketOtherEventsWithL2Rule/MyFuncA","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"0.0.0","metadata":[{"runtime":"*","handler":"*","code":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"L2BucketOtherEventsWithL2Rule/MyFuncA/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"L2BucketOtherEventsWithL2Rule/MyFuncA/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/MyFuncA/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/MyFuncA/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nexports.handler = async (event) => {\n  console.log(\"New Project event:\", JSON.stringify(event, null, 2));\n  return {};\n};\n"},"handler":"index.handler","role":{"Fn::GetAtt":["MyFuncAServiceRole9A674AAA","Arn"]},"runtime":"nodejs22.x"}}},"LogGroup":{"id":"LogGroup","path":"L2BucketOtherEventsWithL2Rule/MyFuncA/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"0.0.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/MyFuncA/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"MyFuncAAF5F3089"}]]},"retentionInDays":731}}}}}}},"Trail":{"id":"Trail","path":"L2BucketOtherEventsWithL2Rule/Trail","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.Trail","version":"0.0.0","metadata":["*",{"addS3EventSelector":[[{"bucket":"*"}],{"readWriteType":"All"}]},{"addEventSelector":["AWS::S3::Object",["*"],{"readWriteType":"All"}]}]},"children":{"S3":{"id":"S3","path":"L2BucketOtherEventsWithL2Rule/Trail/S3","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0","metadata":[{"enforceSSL":true}]},"children":{"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/Trail/S3/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}},"Policy":{"id":"Policy","path":"L2BucketOtherEventsWithL2Rule/Trail/S3/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"0.0.0","metadata":[{"bucket":"*"}]},"children":{"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/Trail/S3/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"TrailS30071F172"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["TrailS30071F172","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/*"]]}]},{"Action":"s3:GetBucketAcl","Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::GetAtt":["TrailS30071F172","Arn"]}},{"Action":"s3:PutObject","Condition":{"StringEquals":{"s3:x-amz-acl":"bucket-owner-full-control"}},"Effect":"Allow","Principal":{"Service":"cloudtrail.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["TrailS30071F172","Arn"]},"/AWSLogs/",{"Ref":"AWS::AccountId"},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/Trail/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudtrail.CfnTrail","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudTrail::Trail","aws:cdk:cloudformation:props":{"enableLogFileValidation":true,"eventSelectors":[{"dataResources":[{"type":"AWS::S3::Object","values":[{"Fn::Join":["",[{"Fn::GetAtt":["bucketL2297FC72A","Arn"]},"/"]]}]}],"readWriteType":"All"}],"includeGlobalServiceEvents":true,"isLogging":true,"isMultiRegionTrail":true,"s3BucketName":{"Ref":"TrailS30071F172"}}}}}},"L2RuleForL1":{"id":"L2RuleForL1","path":"L2BucketOtherEventsWithL2Rule/L2RuleForL1","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"targets":"*"},{"addEventPattern":["*"]},{"addTarget":[{}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]}]},"children":{"Resource":{"id":"Resource","path":"L2BucketOtherEventsWithL2Rule/L2RuleForL1/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"eventPattern":{"source":["aws.s3"],"detail-type":["Object Created","Object Deleted"],"detail":{"bucket":{"name":[{"Ref":"bucketL2297FC72A"}]},"reason":["PutObject","DeleteObject"]}},"state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]}}]}}},"AllowEventRuleL2BucketOtherEventsWithL2RuleMyFuncA23B22BFE":{"id":"AllowEventRuleL2BucketOtherEventsWithL2RuleMyFuncA23B22BFE","path":"L2BucketOtherEventsWithL2Rule/L2RuleForL1/AllowEventRuleL2BucketOtherEventsWithL2RuleMyFuncA23B22BFE","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["L2RuleForL13AA6354B","Arn"]}}}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"L2BucketOtherEventsWithL2Rule/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"L2BucketOtherEventsWithL2Rule/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"Bucket-Test":{"id":"Bucket-Test","path":"Bucket-Test","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTest","version":"0.0.0"},"children":{"DefaultTest":{"id":"DefaultTest","path":"Bucket-Test/DefaultTest","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTestCase","version":"0.0.0"},"children":{"Default":{"id":"Default","path":"Bucket-Test/DefaultTest/Default","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}},"DeployAssert":{"id":"DeployAssert","path":"Bucket-Test/DefaultTest/DeployAssert","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"BootstrapVersion":{"id":"BootstrapVersion","path":"Bucket-Test/DefaultTest/DeployAssert/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"Bucket-Test/DefaultTest/DeployAssert/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}}}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}}}}}