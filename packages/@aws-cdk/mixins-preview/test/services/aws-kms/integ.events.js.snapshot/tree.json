{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"0.0.0"},"children":{"L1L2KeyWithL2Rule":{"id":"L1L2KeyWithL2Rule","path":"L1L2KeyWithL2Rule","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"KeyL1":{"id":"KeyL1","path":"L1L2KeyWithL2Rule/KeyL1","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnKey","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Key","aws:cdk:cloudformation:props":{}}},"KeyL2":{"id":"KeyL2","path":"L1L2KeyWithL2Rule/KeyL2","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Key","version":"0.0.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"L1L2KeyWithL2Rule/KeyL2/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnKey","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Key","aws:cdk:cloudformation:props":{"keyPolicy":{"Statement":[{"Action":"kms:*","Effect":"Allow","Principal":{"AWS":{"Fn::Join":["",["arn:aws:iam::",{"Ref":"AWS::AccountId"},":root"]]}},"Resource":"*"}],"Version":"2012-10-17"}}}}}},"MyFuncA":{"id":"MyFuncA","path":"L1L2KeyWithL2Rule/MyFuncA","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"0.0.0","metadata":[{"runtime":"*","handler":"*","code":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"L1L2KeyWithL2Rule/MyFuncA/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"L1L2KeyWithL2Rule/MyFuncA/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"L1L2KeyWithL2Rule/MyFuncA/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"L1L2KeyWithL2Rule/MyFuncA/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nexports.handler = async (event) => {\n  console.log(\"New Project event:\", JSON.stringify(event, null, 2));\n  return {};\n};\n"},"handler":"index.handler","role":{"Fn::GetAtt":["MyFuncAServiceRole9A674AAA","Arn"]},"runtime":"nodejs22.x"}}},"LogGroup":{"id":"LogGroup","path":"L1L2KeyWithL2Rule/MyFuncA/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"0.0.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"L1L2KeyWithL2Rule/MyFuncA/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"MyFuncAAF5F3089"}]]},"retentionInDays":731}}}}}}},"L2RuleForL1":{"id":"L2RuleForL1","path":"L1L2KeyWithL2Rule/L2RuleForL1","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"targets":"*"},{"addEventPattern":["*"]},{"addTarget":[{}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]}]},"children":{"Resource":{"id":"Resource","path":"L1L2KeyWithL2Rule/L2RuleForL1/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"eventPattern":{"source":["aws.kms"],"detail-type":["AWS API Call via CloudTrail"],"detail":{"requestParameters":{"keyId":[{"Ref":"KeyL1"},{"Ref":"KeyL25E747C61"}]},"eventName":["RotateKeyOnDemand"]}},"state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]}}]}}},"AllowEventRuleL1L2KeyWithL2RuleMyFuncAA6804792":{"id":"AllowEventRuleL1L2KeyWithL2RuleMyFuncAA6804792","path":"L1L2KeyWithL2Rule/L2RuleForL1/AllowEventRuleL1L2KeyWithL2RuleMyFuncAA6804792","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["L2RuleForL13AA6354B","Arn"]}}}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"L1L2KeyWithL2Rule/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"L1L2KeyWithL2Rule/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"L2KeyOtherEventsWithL2Rule":{"id":"L2KeyOtherEventsWithL2Rule","path":"L2KeyOtherEventsWithL2Rule","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"Key":{"id":"Key","path":"L2KeyOtherEventsWithL2Rule/Key","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Key","version":"0.0.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"L2KeyOtherEventsWithL2Rule/Key/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnKey","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Key","aws:cdk:cloudformation:props":{"keyPolicy":{"Statement":[{"Action":"kms:*","Effect":"Allow","Principal":{"AWS":{"Fn::Join":["",["arn:aws:iam::",{"Ref":"AWS::AccountId"},":root"]]}},"Resource":"*"}],"Version":"2012-10-17"}}}}}},"MyFuncA":{"id":"MyFuncA","path":"L2KeyOtherEventsWithL2Rule/MyFuncA","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"0.0.0","metadata":[{"runtime":"*","handler":"*","code":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"L2KeyOtherEventsWithL2Rule/MyFuncA/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"L2KeyOtherEventsWithL2Rule/MyFuncA/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"L2KeyOtherEventsWithL2Rule/MyFuncA/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"L2KeyOtherEventsWithL2Rule/MyFuncA/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nexports.handler = async (event) => {\n  console.log(\"New Project event:\", JSON.stringify(event, null, 2));\n  return {};\n};\n"},"handler":"index.handler","role":{"Fn::GetAtt":["MyFuncAServiceRole9A674AAA","Arn"]},"runtime":"nodejs22.x"}}},"LogGroup":{"id":"LogGroup","path":"L2KeyOtherEventsWithL2Rule/MyFuncA/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"0.0.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"L2KeyOtherEventsWithL2Rule/MyFuncA/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"MyFuncAAF5F3089"}]]},"retentionInDays":731}}}}}}},"L2RuleForL1":{"id":"L2RuleForL1","path":"L2KeyOtherEventsWithL2Rule/L2RuleForL1","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"targets":"*"},{"addEventPattern":["*"]},{"addTarget":[{}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]},{"addEventPattern":[{"source":"*","detailType":"*","detail":"*","version":"*","resources":"*","region":"*"}]}]},"children":{"Resource":{"id":"Resource","path":"L2KeyOtherEventsWithL2Rule/L2RuleForL1/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"eventPattern":{"source":["aws.kms"],"detail-type":["KMS CMK Deletion","KMS CMK Rotation"],"detail":{"key-id":[{"Ref":"Key961B73FD"}]}},"state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]}}]}}},"AllowEventRuleL2KeyOtherEventsWithL2RuleMyFuncADDE2D2B6":{"id":"AllowEventRuleL2KeyOtherEventsWithL2RuleMyFuncADDE2D2B6","path":"L2KeyOtherEventsWithL2Rule/L2RuleForL1/AllowEventRuleL2KeyOtherEventsWithL2RuleMyFuncADDE2D2B6","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["MyFuncAAF5F3089","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["L2RuleForL13AA6354B","Arn"]}}}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"L2KeyOtherEventsWithL2Rule/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"L2KeyOtherEventsWithL2Rule/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"Key-Test":{"id":"Key-Test","path":"Key-Test","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTest","version":"0.0.0"},"children":{"DefaultTest":{"id":"DefaultTest","path":"Key-Test/DefaultTest","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTestCase","version":"0.0.0"},"children":{"Default":{"id":"Default","path":"Key-Test/DefaultTest/Default","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}},"DeployAssert":{"id":"DeployAssert","path":"Key-Test/DefaultTest/DeployAssert","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"BootstrapVersion":{"id":"BootstrapVersion","path":"Key-Test/DefaultTest/DeployAssert/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"Key-Test/DefaultTest/DeployAssert/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}}}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}}}}}