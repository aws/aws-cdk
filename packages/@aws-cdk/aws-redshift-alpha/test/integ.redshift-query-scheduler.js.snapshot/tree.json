{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"0.0.0"},"children":{"aws-redshift-alpha-query-scheduler":{"id":"aws-redshift-alpha-query-scheduler","path":"aws-redshift-alpha-query-scheduler","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"ClusterScheduler":{"id":"ClusterScheduler","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler","constructInfo":{"fqn":"@aws-cdk/aws-redshift-alpha.RedshiftQueryScheduler","version":"0.0.0"},"children":{"Rule":{"id":"Rule","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler/Rule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"ruleName":"*","schedule":"*","description":"*","enabled":true},{"addEventPattern":["*"]},{"addTarget":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler/Rule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Daily order count report for cluster","name":"QS2-cluster-daily-report","scheduleExpression":"rate(1 day)","state":"ENABLED","targets":[{"id":"Target0","arn":"arn:aws:redshift:us-east-1:123456789012:cluster:test-cluster","roleArn":{"Fn::GetAtt":["ClusterSchedulerRuleEventsRole346D0951","Arn"]},"redshiftDataParameters":{"database":"analytics","dbUser":"scheduler_user","sql":"SELECT COUNT(*) FROM orders WHERE created_date = CURRENT_DATE","statementName":"QS2-cluster-daily-report","withEvent":true}}]}}},"EventsRole":{"id":"EventsRole","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler/Rule/EventsRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[{"roleName":"*","assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportEventsRole":{"id":"ImportEventsRole","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler/Rule/EventsRole/ImportEventsRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler/Rule/EventsRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"events.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler/Rule/EventsRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"0.0.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/ClusterScheduler/Rule/EventsRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"redshift-data:ExecuteStatement","Effect":"Allow","Resource":"arn:aws:redshift:us-east-1:123456789012:cluster:test-cluster"}],"Version":"2012-10-17"},"policyName":"ClusterSchedulerRuleEventsRoleDefaultPolicy9DF76113","roles":[{"Ref":"ClusterSchedulerRuleEventsRole346D0951"}]}}}}}}}}}}},"WorkgroupScheduler":{"id":"WorkgroupScheduler","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler","constructInfo":{"fqn":"@aws-cdk/aws-redshift-alpha.RedshiftQueryScheduler","version":"0.0.0"},"children":{"Rule":{"id":"Rule","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Rule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"ruleName":"*","schedule":"*","description":"*","enabled":true},{"addEventPattern":["*"]},{"addTarget":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Rule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Hourly cleanup for workgroup","name":"QS2-workgroup-hourly-cleanup","scheduleExpression":"rate(1 hour)","state":"ENABLED","targets":[{"id":"Target0","arn":"arn:aws:redshift-serverless:us-east-1:123456789012:workgroup/test-workgroup","roleArn":{"Fn::GetAtt":["WorkgroupSchedulerRuleEventsRole36C21F42","Arn"]},"redshiftDataParameters":{"database":"warehouse","secretManagerArn":"arn:aws:secretsmanager:us-east-1:123456789012:secret:redshift-credentials-abc123","sqls":["DELETE FROM temp_table WHERE created_at < CURRENT_TIMESTAMP - INTERVAL '1 hour'","VACUUM temp_table","ANALYZE temp_table"],"statementName":"QS2-workgroup-hourly-cleanup","withEvent":true}}]}}},"EventsRole":{"id":"EventsRole","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Rule/EventsRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[{"roleName":"*","assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportEventsRole":{"id":"ImportEventsRole","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Rule/EventsRole/ImportEventsRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Rule/EventsRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"events.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Rule/EventsRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"0.0.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Rule/EventsRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"redshift-data:BatchExecuteStatement","Effect":"Allow","Resource":"arn:aws:redshift-serverless:us-east-1:123456789012:workgroup/test-workgroup"}],"Version":"2012-10-17"},"policyName":"WorkgroupSchedulerRuleEventsRoleDefaultPolicyD52F34D7","roles":[{"Ref":"WorkgroupSchedulerRuleEventsRole36C21F42"}]}}}}}}}}},"Secret":{"id":"Secret","path":"aws-redshift-alpha-query-scheduler/WorkgroupScheduler/Secret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":[]}}}},"DisabledScheduler":{"id":"DisabledScheduler","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler","constructInfo":{"fqn":"@aws-cdk/aws-redshift-alpha.RedshiftQueryScheduler","version":"0.0.0"},"children":{"Rule":{"id":"Rule","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler/Rule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"ruleName":"*","schedule":"*","description":"*","enabled":false},{"addEventPattern":["*"]},{"addTarget":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler/Rule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Disabled scheduler for testing","name":"QS2-disabled-test","scheduleExpression":"rate(30 minutes)","state":"DISABLED","targets":[{"id":"Target0","arn":"arn:aws:redshift:us-east-1:123456789012:cluster:test-cluster-2","roleArn":{"Fn::GetAtt":["DisabledSchedulerRuleEventsRoleAFECDCB4","Arn"]},"redshiftDataParameters":{"database":"test_db","dbUser":"test_user","sql":"SELECT 1","statementName":"QS2-disabled-test","withEvent":true}}]}}},"EventsRole":{"id":"EventsRole","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler/Rule/EventsRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[{"roleName":"*","assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportEventsRole":{"id":"ImportEventsRole","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler/Rule/EventsRole/ImportEventsRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler/Rule/EventsRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"events.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler/Rule/EventsRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"0.0.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/DisabledScheduler/Rule/EventsRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"redshift-data:ExecuteStatement","Effect":"Allow","Resource":"arn:aws:redshift:us-east-1:123456789012:cluster:test-cluster-2"}],"Version":"2012-10-17"},"policyName":"DisabledSchedulerRuleEventsRoleDefaultPolicyED0B743B","roles":[{"Ref":"DisabledSchedulerRuleEventsRoleAFECDCB4"}]}}}}}}}}}}},"CustomRedshiftRole":{"id":"CustomRedshiftRole","path":"aws-redshift-alpha-query-scheduler/CustomRedshiftRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"description":"*"},{"addToPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportCustomRedshiftRole":{"id":"ImportCustomRedshiftRole","path":"aws-redshift-alpha-query-scheduler/CustomRedshiftRole/ImportCustomRedshiftRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/CustomRedshiftRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"events.amazonaws.com"}}],"Version":"2012-10-17"},"description":"Custom role for Redshift query execution"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"aws-redshift-alpha-query-scheduler/CustomRedshiftRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"0.0.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/CustomRedshiftRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["redshift-data:DescribeStatement","redshift-data:ExecuteStatement","redshift-data:GetStatementResult"],"Effect":"Allow","Resource":"*"},{"Action":"redshift-data:ExecuteStatement","Effect":"Allow","Resource":"arn:aws:redshift:us-east-1:123456789012:cluster:test-cluster"}],"Version":"2012-10-17"},"policyName":"CustomRedshiftRoleDefaultPolicy85816695","roles":[{"Ref":"CustomRedshiftRole1EB1A91A"}]}}}}}}},"CustomRoleScheduler":{"id":"CustomRoleScheduler","path":"aws-redshift-alpha-query-scheduler/CustomRoleScheduler","constructInfo":{"fqn":"@aws-cdk/aws-redshift-alpha.RedshiftQueryScheduler","version":"0.0.0"},"children":{"Rule":{"id":"Rule","path":"aws-redshift-alpha-query-scheduler/CustomRoleScheduler/Rule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"0.0.0","metadata":[{"ruleName":"*","schedule":"*","description":"*","enabled":true},{"addEventPattern":["*"]},{"addTarget":[{}]}]},"children":{"Resource":{"id":"Resource","path":"aws-redshift-alpha-query-scheduler/CustomRoleScheduler/Rule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Scheduler with custom IAM role","name":"QS2-custom-role-test","scheduleExpression":"rate(12 hours)","state":"ENABLED","targets":[{"id":"Target0","arn":"arn:aws:redshift:us-east-1:123456789012:cluster:test-cluster","roleArn":{"Fn::GetAtt":["CustomRedshiftRole1EB1A91A","Arn"]},"redshiftDataParameters":{"database":"analytics","dbUser":"scheduler_user","sql":"SELECT COUNT(*) FROM users","statementName":"QS2-custom-role-test","withEvent":true}}]}}}}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"aws-redshift-alpha-query-scheduler/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"aws-redshift-alpha-query-scheduler/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"RedshiftQuerySchedulerIntegTest":{"id":"RedshiftQuerySchedulerIntegTest","path":"RedshiftQuerySchedulerIntegTest","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTest","version":"0.0.0"},"children":{"DefaultTest":{"id":"DefaultTest","path":"RedshiftQuerySchedulerIntegTest/DefaultTest","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTestCase","version":"0.0.0"},"children":{"Default":{"id":"Default","path":"RedshiftQuerySchedulerIntegTest/DefaultTest/Default","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"DeployAssert":{"id":"DeployAssert","path":"RedshiftQuerySchedulerIntegTest/DefaultTest/DeployAssert","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"BootstrapVersion":{"id":"BootstrapVersion","path":"RedshiftQuerySchedulerIntegTest/DefaultTest/DeployAssert/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"RedshiftQuerySchedulerIntegTest/DefaultTest/DeployAssert/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}}}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}