"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const path = require("path");
const cdk_build_tools_1 = require("@aws-cdk/cdk-build-tools");
const cxschema = require("@aws-cdk/cloud-assembly-schema");
const core_1 = require("@aws-cdk/core");
const cxapi = require("@aws-cdk/cx-api");
const lib_1 = require("../lib");
const DEMO_IMAGE_ASSET_HASH = '0a3355be12051c9984bf2b0b2bba4e6ea535968e5b6e7396449701732fe5ed14';
describe('image asset', () => {
    test('fails if the directory does not exist', () => {
        const stack = new core_1.Stack();
        // THEN
        expect(() => {
            new lib_1.DockerImageAsset(stack, 'MyAsset', {
                directory: `/does/not/exist/${Math.floor(Math.random() * 9999)}`,
            });
        }).toThrow(/Cannot find image directory at/);
    });
    test('fails if the directory does not contain a Dockerfile', () => {
        const stack = new core_1.Stack();
        // THEN
        expect(() => {
            new lib_1.DockerImageAsset(stack, 'Asset', {
                directory: __dirname,
            });
        }).toThrow(/Cannot find file at/);
    });
    test('fails if the file does not exist', () => {
        const stack = new core_1.Stack();
        // THEN
        expect(() => {
            new lib_1.DockerImageAsset(stack, 'Asset', {
                directory: __dirname,
                file: 'doesnt-exist',
            });
        }).toThrow(/Cannot find file at/);
    });
    test('docker directory is staged if asset staging is enabled', () => {
        const app = new core_1.App();
        const stack = new core_1.Stack(app);
        const image = new lib_1.DockerImageAsset(stack, 'MyAsset', {
            directory: path.join(__dirname, 'demo-image'),
        });
        const session = app.synth();
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'Dockerfile'))).toBe(true);
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'index.py'))).toBe(true);
    });
    cdk_build_tools_1.describeDeprecated('docker ignore option', () => {
        // The 'ignoreMode' property is both deprecated and not deprecated in DockerImageAssetProps interface.
        // The interface through a complex set of inheritance chain has a 'ignoreMode' prop that is deprecated
        // and another 'ignoreMode' prop that is not deprecated.
        // Using a 'describeDeprecated' block here since there's no way to work around this craziness.
        // When the deprecated property is removed source code, this block can be dropped.
        test('docker directory is staged without files specified in .dockerignore', () => {
            const app = new core_1.App();
            testDockerDirectoryIsStagedWithoutFilesSpecifiedInDockerignore(app);
        });
        test('docker directory is staged without files specified in .dockerignore with IgnoreMode.GLOB', () => {
            const app = new core_1.App();
            testDockerDirectoryIsStagedWithoutFilesSpecifiedInDockerignore(app, core_1.IgnoreMode.GLOB);
        });
    });
    test('docker directory is staged with allow-listed files specified in .dockerignore', () => {
        const app = new core_1.App();
        const stack = new core_1.Stack(app);
        const image = new lib_1.DockerImageAsset(stack, 'MyAsset', {
            directory: path.join(__dirname, 'allow-listed-image'),
        });
        const session = app.synth();
        // Only the files exempted above should be included.
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, '.dockerignore'))).toBe(true);
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'Dockerfile'))).toBe(true);
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'index.py'))).toBe(true);
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'foobar.txt'))).toBe(true);
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'subdirectory'))).toBe(true);
        expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'subdirectory', 'baz.txt'))).toBe(true);
        expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'node_modules'))).toBe(true);
        expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'node_modules', 'one'))).toBe(true);
        expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'node_modules', 'some_dep'))).toBe(true);
        expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'node_modules', 'some_dep', 'file'))).toBe(true);
    });
    test('docker directory is staged without files specified in exclude option', () => {
        const app = new core_1.App();
        testDockerDirectoryIsStagedWithoutFilesSpecifiedInExcludeOption(app);
    });
    test('docker directory is staged without files specified in exclude option with IgnoreMode.GLOB', () => {
        const app = new core_1.App();
        testDockerDirectoryIsStagedWithoutFilesSpecifiedInExcludeOption(app, core_1.IgnoreMode.GLOB);
    });
    test('fails if using tokens in build args keys or values', () => {
        // GIVEN
        const stack = new core_1.Stack();
        const token = core_1.Lazy.string({ produce: () => 'foo' });
        const expected = /Cannot use tokens in keys or values of "buildArgs" since they are needed before deployment/;
        // THEN
        expect(() => new lib_1.DockerImageAsset(stack, 'MyAsset1', {
            directory: path.join(__dirname, 'demo-image'),
            buildArgs: { [token]: 'value' },
        })).toThrow(expected);
        expect(() => new lib_1.DockerImageAsset(stack, 'MyAsset2', {
            directory: path.join(__dirname, 'demo-image'),
            buildArgs: { key: token },
        })).toThrow(expected);
    });
    cdk_build_tools_1.testDeprecated('fails if using token as repositoryName', () => {
        // GIVEN
        const stack = new core_1.Stack();
        const token = core_1.Lazy.string({ produce: () => 'foo' });
        // THEN
        expect(() => new lib_1.DockerImageAsset(stack, 'MyAsset1', {
            directory: path.join(__dirname, 'demo-image'),
            repositoryName: token,
        })).toThrow(/Cannot use Token as value of 'repositoryName'/);
    });
    test('docker build options are included in the asset id', () => {
        // GIVEN
        const app = new core_1.App();
        const stack = new core_1.Stack(app);
        const directory = path.join(__dirname, 'demo-image-custom-docker-file');
        const asset1 = new lib_1.DockerImageAsset(stack, 'Asset1', { directory });
        const asset2 = new lib_1.DockerImageAsset(stack, 'Asset2', { directory, file: 'Dockerfile.Custom' });
        const asset3 = new lib_1.DockerImageAsset(stack, 'Asset3', { directory, target: 'NonDefaultTarget' });
        const asset4 = new lib_1.DockerImageAsset(stack, 'Asset4', { directory, buildArgs: { opt1: '123', opt2: 'boom' } });
        const asset5 = new lib_1.DockerImageAsset(stack, 'Asset5', { directory, file: 'Dockerfile.Custom', target: 'NonDefaultTarget' });
        const asset6 = new lib_1.DockerImageAsset(stack, 'Asset6', { directory, extraHash: 'random-extra' });
        const asset7 = new lib_1.DockerImageAsset(stack, 'Asset7', { directory, outputs: ['123'] });
        const asset8 = new lib_1.DockerImageAsset(stack, 'Asset8', { directory, buildSecrets: { mySecret: core_1.DockerBuildSecret.fromSrc('abc.txt') } });
        expect(asset1.assetHash).toEqual('13248c55633f3b198a628bb2ea4663cb5226f8b2801051bd0c725950266fd590');
        expect(asset2.assetHash).toEqual('36bf205fb9adc5e45ba1c8d534158a0aed96d190eff433af1d90f3b94f96e751');
        expect(asset3.assetHash).toEqual('4c85bd70e73117b7129c2defbe6dc40a8a3872329f4ddca18d75afa671b38276');
        expect(asset4.assetHash).toEqual('8a91219a7bb0f58b3282dd84acbf4c03c49c765be54ffb7b125be6a50b6c5645');
        expect(asset5.assetHash).toEqual('c02bfba13b2e7e1ff5c778a76e10296b9e8d17f7f8252d097f4170ae04ce0eb4');
        expect(asset6.assetHash).toEqual('3528d6838647a5e9011b0f35aec514d03ad11af05a94653cdcf4dacdbb070a06');
        expect(asset7.assetHash).toEqual('ced0a3076efe217f9cbdff0943e543f36ecf77f70b9a6fe28b8633deb728a462');
        expect(asset8.assetHash).toEqual('ffc2718e616141d18c8f4623d13cdfd68cb8f010ca5db31c916c8b5f10c162be');
    });
    cdk_build_tools_1.testDeprecated('repositoryName is included in the asset id', () => {
        const stack = new core_1.Stack();
        const directory = path.join(__dirname, 'demo-image-custom-docker-file');
        const asset1 = new lib_1.DockerImageAsset(stack, 'Asset1', { directory });
        const asset2 = new lib_1.DockerImageAsset(stack, 'Asset2', { directory, repositoryName: 'foo' });
        expect(asset1.assetHash).toEqual('13248c55633f3b198a628bb2ea4663cb5226f8b2801051bd0c725950266fd590');
        expect(asset2.assetHash).toEqual('b78978ca702a8eccd37804ce31d76cd83a695b557dbf95aeb109332ee8b1fd32');
    });
    describe('imageTag is correct for different stack synthesizers', () => {
        const stack1 = new core_1.Stack();
        const stack2 = new core_1.Stack(undefined, undefined, {
            synthesizer: new core_1.DefaultStackSynthesizer({
                dockerTagPrefix: 'banana',
            }),
        });
        const directory = path.join(__dirname, 'demo-image-custom-docker-file');
        const asset1 = new lib_1.DockerImageAsset(stack1, 'Asset1', { directory });
        const asset2 = new lib_1.DockerImageAsset(stack2, 'Asset2', { directory });
        test('stack with default synthesizer', () => {
            expect(asset1.assetHash).toEqual('13248c55633f3b198a628bb2ea4663cb5226f8b2801051bd0c725950266fd590');
            expect(asset1.imageTag).toEqual('13248c55633f3b198a628bb2ea4663cb5226f8b2801051bd0c725950266fd590');
        });
        test('stack with overwritten synthesizer', () => {
            expect(asset2.assetHash).toEqual('13248c55633f3b198a628bb2ea4663cb5226f8b2801051bd0c725950266fd590');
            expect(asset2.imageTag).toEqual('banana13248c55633f3b198a628bb2ea4663cb5226f8b2801051bd0c725950266fd590');
        });
    });
});
function testDockerDirectoryIsStagedWithoutFilesSpecifiedInDockerignore(app, ignoreMode) {
    const stack = new core_1.Stack(app);
    const image = new lib_1.DockerImageAsset(stack, 'MyAsset', {
        ignoreMode,
        directory: path.join(__dirname, 'dockerignore-image'),
    });
    const session = app.synth();
    // .dockerignore itself should be included in output to be processed during docker build
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, '.dockerignore'))).toBe(true);
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'Dockerfile'))).toBe(true);
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'index.py'))).toBe(true);
    expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'foobar.txt'))).toBe(true);
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'subdirectory'))).toBe(true);
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'subdirectory', 'baz.txt'))).toBe(true);
}
function testDockerDirectoryIsStagedWithoutFilesSpecifiedInExcludeOption(app, ignoreMode) {
    const stack = new core_1.Stack(app);
    const image = new lib_1.DockerImageAsset(stack, 'MyAsset', {
        directory: path.join(__dirname, 'dockerignore-image'),
        exclude: ['subdirectory'],
        ignoreMode,
    });
    const session = app.synth();
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, '.dockerignore'))).toBe(true);
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'Dockerfile'))).toBe(true);
    expect(fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'index.py'))).toBe(true);
    expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'foobar.txt'))).toBe(true);
    expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'subdirectory'))).toBe(true);
    expect(!fs.existsSync(path.join(session.directory, `asset.${image.assetHash}`, 'subdirectory', 'baz.txt'))).toBe(true);
}
test('nested assemblies share assets: legacy synth edition', () => {
    // GIVEN
    const app = new core_1.App();
    const stack1 = new core_1.Stack(new core_1.Stage(app, 'Stage1'), 'Stack', { synthesizer: new core_1.LegacyStackSynthesizer() });
    const stack2 = new core_1.Stack(new core_1.Stage(app, 'Stage2'), 'Stack', { synthesizer: new core_1.LegacyStackSynthesizer() });
    // WHEN
    new lib_1.DockerImageAsset(stack1, 'Image', { directory: path.join(__dirname, 'demo-image') });
    new lib_1.DockerImageAsset(stack2, 'Image', { directory: path.join(__dirname, 'demo-image') });
    // THEN
    const assembly = app.synth();
    // Read the assets from the stack metadata
    for (const stageName of ['Stage1', 'Stage2']) {
        const stackArtifact = assembly.getNestedAssembly(`assembly-${stageName}`).artifacts.filter(isStackArtifact)[0];
        const assetMeta = stackArtifact.findMetadataByType(cxschema.ArtifactMetadataEntryType.ASSET);
        expect(assetMeta[0]).toEqual(expect.objectContaining({
            data: expect.objectContaining({
                path: `../asset.${DEMO_IMAGE_ASSET_HASH}`,
            }),
        }));
    }
});
test('nested assemblies share assets: default synth edition', () => {
    // GIVEN
    const app = new core_1.App();
    const stack1 = new core_1.Stack(new core_1.Stage(app, 'Stage1'), 'Stack', { synthesizer: new core_1.DefaultStackSynthesizer() });
    const stack2 = new core_1.Stack(new core_1.Stage(app, 'Stage2'), 'Stack', { synthesizer: new core_1.DefaultStackSynthesizer() });
    // WHEN
    new lib_1.DockerImageAsset(stack1, 'Image', { directory: path.join(__dirname, 'demo-image') });
    new lib_1.DockerImageAsset(stack2, 'Image', { directory: path.join(__dirname, 'demo-image') });
    // THEN
    const assembly = app.synth();
    // Read the asset manifests to verify the file paths
    for (const stageName of ['Stage1', 'Stage2']) {
        const manifestArtifact = assembly.getNestedAssembly(`assembly-${stageName}`).artifacts.filter(cxapi.AssetManifestArtifact.isAssetManifestArtifact)[0];
        const manifest = JSON.parse(fs.readFileSync(manifestArtifact.file, { encoding: 'utf-8' }));
        expect(manifest.dockerImages[DEMO_IMAGE_ASSET_HASH].source).toEqual({
            directory: `../asset.${DEMO_IMAGE_ASSET_HASH}`,
        });
    }
});
function isStackArtifact(x) {
    return x instanceof cxapi.CloudFormationStackArtifact;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2UtYXNzZXQudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImltYWdlLWFzc2V0LnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx5QkFBeUI7QUFDekIsNkJBQTZCO0FBQzdCLDhEQUE4RTtBQUM5RSwyREFBMkQ7QUFDM0Qsd0NBQXdJO0FBQ3hJLHlDQUF5QztBQUN6QyxnQ0FBMEM7QUFFMUMsTUFBTSxxQkFBcUIsR0FBRyxrRUFBa0UsQ0FBQztBQUVqRyxRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtJQUMzQixJQUFJLENBQUMsdUNBQXVDLEVBQUUsR0FBRyxFQUFFO1FBQ2pELE1BQU0sS0FBSyxHQUFHLElBQUksWUFBSyxFQUFFLENBQUM7UUFDMUIsT0FBTztRQUNQLE1BQU0sQ0FBQyxHQUFHLEVBQUU7WUFDVixJQUFJLHNCQUFnQixDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUU7Z0JBQ3JDLFNBQVMsRUFBRSxtQkFBbUIsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUU7YUFDakUsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLGdDQUFnQyxDQUFDLENBQUM7SUFFL0MsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsc0RBQXNELEVBQUUsR0FBRyxFQUFFO1FBQ2hFLE1BQU0sS0FBSyxHQUFHLElBQUksWUFBSyxFQUFFLENBQUM7UUFDMUIsT0FBTztRQUNQLE1BQU0sQ0FBQyxHQUFHLEVBQUU7WUFDVixJQUFJLHNCQUFnQixDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUU7Z0JBQ25DLFNBQVMsRUFBRSxTQUFTO2FBQ3JCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0lBRXBDLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFB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VSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxTQUFTLEtBQUssQ0FBQyxTQUFTLEVBQUUsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3pHLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxTQUFTLEtBQUssQ0FBQyxTQUFTLEVBQUUsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3ZHLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxTQUFTLEtBQUssQ0FBQyxTQUFTLEVBQUUsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3pHLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxTQUFTLEtBQUssQ0FBQyxTQUFTLEVBQUUsRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNHLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxTQUFTLEtBQUssQ0FBQyxTQUFTLEVBQUUsRUFBRSxjQUFjLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN0SCxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxTQUFTLEtBQUssQ0FBQyxTQUFTLEVBQUUsRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFB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ICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgZGVzY3JpYmVEZXByZWNhdGVkLCB0ZXN0RGVwcmVjYXRlZCB9IGZyb20gJ0Bhd3MtY2RrL2Nkay1idWlsZC10b29scyc7XG5pbXBvcnQgKiBhcyBjeHNjaGVtYSBmcm9tICdAYXdzLWNkay9jbG91ZC1hc3NlbWJseS1zY2hlbWEnO1xuaW1wb3J0IHsgQXBwLCBEZWZhdWx0U3RhY2tTeW50aGVzaXplciwgRG9ja2VyQnVpbGRTZWNyZXQsIElnbm9yZU1vZGUsIExhenksIExlZ2FjeVN0YWNrU3ludGhlc2l6ZXIsIFN0YWNrLCBTdGFnZSB9IGZyb20gJ0Bhd3MtY2RrL2NvcmUnO1xuaW1wb3J0ICogYXMgY3hhcGkgZnJvbSAnQGF3cy1jZGsvY3gtYXBpJztcbmltcG9ydCB7IERvY2tlckltYWdlQXNzZXQgfSBmcm9tICcuLi9saWInO1xuXG5jb25zdCBERU1PX0lNQUdFX0FTU0VUX0hBU0ggPSAnMGEzMzU1YmUxMjA1MWM5OTg0YmYyYjBiMmJiYTRlNmVhNTM1OTY4ZTViNmU3Mzk2NDQ5NzAxNzMyZmU1ZWQxNCc7XG5cbmRlc2NyaWJlKCdpbWFnZSBhc3NldCcsICgpID0+IHtcbiAgdGVzdCgnZmFpbHMgaWYgdGhlIGRpcmVjdG9yeSBkb2VzIG5vdCBleGlzdCcsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBTdGFjaygpO1xuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdNeUFzc2V0Jywge1xuICAgICAgICBkaXJlY3Rvcnk6IGAvZG9lcy9ub3QvZXhpc3QvJHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA5OTk5KX1gLFxuICAgICAgfSk7XG4gICAgfSkudG9UaHJvdygvQ2Fubm90IGZpbmQgaW1hZ2UgZGlyZWN0b3J5IGF0Lyk7XG5cbiAgfSk7XG5cbiAgdGVzdCgnZmFpbHMgaWYgdGhlIGRpcmVjdG9yeSBkb2VzIG5vdCBjb250YWluIGEgRG9ja2VyZmlsZScsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBTdGFjaygpO1xuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdBc3NldCcsIHtcbiAgICAgICAgZGlyZWN0b3J5OiBfX2Rpcm5hbWUsXG4gICAgICB9KTtcbiAgICB9KS50b1Rocm93KC9DYW5ub3QgZmluZCBmaWxlIGF0Lyk7XG5cbiAgfSk7XG5cbiAgdGVzdCgnZmFpbHMgaWYgdGhlIGZpbGUgZG9lcyBub3QgZXhpc3QnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgU3RhY2soKTtcbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIG5ldyBEb2NrZXJJbWFnZUFzc2V0KHN0YWNrLCAnQXNzZXQnLCB7XG4gICAgICAgIGRpcmVjdG9yeTogX19kaXJuYW1lLFxuICAgICAgICBmaWxlOiAnZG9lc250LWV4aXN0JyxcbiAgICAgIH0pO1xuICAgIH0pLnRvVGhyb3coL0Nhbm5vdCBmaW5kIGZpbGUgYXQvKTtcblxuICB9KTtcblxuICB0ZXN0KCdkb2NrZXIgZGlyZWN0b3J5IGlzIHN0YWdlZCBpZiBhc3NldCBzdGFnaW5nIGlzIGVuYWJsZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKGFwcCk7XG4gICAgY29uc3QgaW1hZ2UgPSBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjaywgJ015QXNzZXQnLCB7XG4gICAgICBkaXJlY3Rvcnk6IHBhdGguam9pbihfX2Rpcm5hbWUsICdkZW1vLWltYWdlJyksXG4gICAgfSk7XG5cbiAgICBjb25zdCBzZXNzaW9uID0gYXBwLnN5bnRoKCk7XG5cbiAgICBleHBlY3QoZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oc2Vzc2lvbi5kaXJlY3RvcnksIGBhc3NldC4ke2ltYWdlLmFzc2V0SGFzaH1gLCAnRG9ja2VyZmlsZScpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oc2Vzc2lvbi5kaXJlY3RvcnksIGBhc3NldC4ke2ltYWdlLmFzc2V0SGFzaH1gLCAnaW5kZXgucHknKSkpLnRvQmUodHJ1ZSk7XG5cbiAgfSk7XG5cbiAgZGVzY3JpYmVEZXByZWNhdGVkKCdkb2NrZXIgaWdub3JlIG9wdGlvbicsICgpID0+IHtcbiAgICAvLyBUaGUgJ2lnbm9yZU1vZGUnIHByb3BlcnR5IGlzIGJvdGggZGVwcmVjYXRlZCBhbmQgbm90IGRlcHJlY2F0ZWQgaW4gRG9ja2VySW1hZ2VBc3NldFByb3BzIGludGVyZmFjZS5cbiAgICAvLyBUaGUgaW50ZXJmYWNlIHRocm91Z2ggYSBjb21wbGV4IHNldCBvZiBpbmhlcml0YW5jZSBjaGFpbiBoYXMgYSAnaWdub3JlTW9kZScgcHJvcCB0aGF0IGlzIGRlcHJlY2F0ZWRcbiAgICAvLyBhbmQgYW5vdGhlciAnaWdub3JlTW9kZScgcHJvcCB0aGF0IGlzIG5vdCBkZXByZWNhdGVkLlxuICAgIC8vIFVzaW5nIGEgJ2Rlc2NyaWJlRGVwcmVjYXRlZCcgYmxvY2sgaGVyZSBzaW5jZSB0aGVyZSdzIG5vIHdheSB0byB3b3JrIGFyb3VuZCB0aGlzIGNyYXppbmVzcy5cbiAgICAvLyBXaGVuIHRoZSBkZXByZWNhdGVkIHByb3BlcnR5IGlzIHJlbW92ZWQgc291cmNlIGNvZGUsIHRoaXMgYmxvY2sgY2FuIGJlIGRyb3BwZWQuXG5cbiAgICB0ZXN0KCdkb2NrZXIgZGlyZWN0b3J5IGlzIHN0YWdlZCB3aXRob3V0IGZpbGVzIHNwZWNpZmllZCBpbiAuZG9ja2VyaWdub3JlJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuICAgICAgdGVzdERvY2tlckRpcmVjdG9yeUlzU3RhZ2VkV2l0aG91dEZpbGVzU3BlY2lmaWVkSW5Eb2NrZXJpZ25vcmUoYXBwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2RvY2tlciBkaXJlY3RvcnkgaXMgc3RhZ2VkIHdpdGhvdXQgZmlsZXMgc3BlY2lmaWVkIGluIC5kb2NrZXJpZ25vcmUgd2l0aCBJZ25vcmVNb2RlLkdMT0InLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcHAgPSBuZXcgQXBwKCk7XG4gICAgICB0ZXN0RG9ja2VyRGlyZWN0b3J5SXNTdGFnZWRXaXRob3V0RmlsZXNTcGVjaWZpZWRJbkRvY2tlcmlnbm9yZShhcHAsIElnbm9yZU1vZGUuR0xPQik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2RvY2tlciBkaXJlY3RvcnkgaXMgc3RhZ2VkIHdpdGggYWxsb3ctbGlzdGVkIGZpbGVzIHNwZWNpZmllZCBpbiAuZG9ja2VyaWdub3JlJywgKCkgPT4ge1xuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBTdGFjayhhcHApO1xuICAgIGNvbnN0IGltYWdlID0gbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdNeUFzc2V0Jywge1xuICAgICAgZGlyZWN0b3J5OiBwYXRoLmpvaW4oX19kaXJuYW1lLCAnYWxsb3ctbGlzdGVkLWltYWdlJyksXG4gICAgfSk7XG5cbiAgICBjb25zdCBzZXNzaW9uID0gYXBwLnN5bnRoKCk7XG5cbiAgICAvLyBPbmx5IHRoZSBmaWxlcyBleGVtcHRlZCBhYm92ZSBzaG91bGQgYmUgaW5jbHVkZWQuXG4gICAgZXhwZWN0KGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJy5kb2NrZXJpZ25vcmUnKSkpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ0RvY2tlcmZpbGUnKSkpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ2luZGV4LnB5JykpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICdmb29iYXIudHh0JykpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICdzdWJkaXJlY3RvcnknKSkpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ3N1YmRpcmVjdG9yeScsICdiYXoudHh0JykpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdCghZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oc2Vzc2lvbi5kaXJlY3RvcnksIGBhc3NldC4ke2ltYWdlLmFzc2V0SGFzaH1gLCAnbm9kZV9tb2R1bGVzJykpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdCghZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oc2Vzc2lvbi5kaXJlY3RvcnksIGBhc3NldC4ke2ltYWdlLmFzc2V0SGFzaH1gLCAnbm9kZV9tb2R1bGVzJywgJ29uZScpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoIWZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ25vZGVfbW9kdWxlcycsICdzb21lX2RlcCcpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoIWZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ25vZGVfbW9kdWxlcycsICdzb21lX2RlcCcsICdmaWxlJykpKS50b0JlKHRydWUpO1xuICB9KTtcblxuICB0ZXN0KCdkb2NrZXIgZGlyZWN0b3J5IGlzIHN0YWdlZCB3aXRob3V0IGZpbGVzIHNwZWNpZmllZCBpbiBleGNsdWRlIG9wdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKCk7XG4gICAgdGVzdERvY2tlckRpcmVjdG9yeUlzU3RhZ2VkV2l0aG91dEZpbGVzU3BlY2lmaWVkSW5FeGNsdWRlT3B0aW9uKGFwcCk7XG4gIH0pO1xuXG4gIHRlc3QoJ2RvY2tlciBkaXJlY3RvcnkgaXMgc3RhZ2VkIHdpdGhvdXQgZmlsZXMgc3BlY2lmaWVkIGluIGV4Y2x1ZGUgb3B0aW9uIHdpdGggSWdub3JlTW9kZS5HTE9CJywgKCkgPT4ge1xuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcbiAgICB0ZXN0RG9ja2VyRGlyZWN0b3J5SXNTdGFnZWRXaXRob3V0RmlsZXNTcGVjaWZpZWRJbkV4Y2x1ZGVPcHRpb24oYXBwLCBJZ25vcmVNb2RlLkdMT0IpO1xuICB9KTtcblxuICB0ZXN0KCdmYWlscyBpZiB1c2luZyB0b2tlbnMgaW4gYnVpbGQgYXJncyBrZXlzIG9yIHZhbHVlcycsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKCk7XG4gICAgY29uc3QgdG9rZW4gPSBMYXp5LnN0cmluZyh7IHByb2R1Y2U6ICgpID0+ICdmb28nIH0pO1xuICAgIGNvbnN0IGV4cGVjdGVkID0gL0Nhbm5vdCB1c2UgdG9rZW5zIGluIGtleXMgb3IgdmFsdWVzIG9mIFwiYnVpbGRBcmdzXCIgc2luY2UgdGhleSBhcmUgbmVlZGVkIGJlZm9yZSBkZXBsb3ltZW50LztcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoKCkgPT4gbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdNeUFzc2V0MScsIHtcbiAgICAgIGRpcmVjdG9yeTogcGF0aC5qb2luKF9fZGlybmFtZSwgJ2RlbW8taW1hZ2UnKSxcbiAgICAgIGJ1aWxkQXJnczogeyBbdG9rZW5dOiAndmFsdWUnIH0sXG4gICAgfSkpLnRvVGhyb3coZXhwZWN0ZWQpO1xuXG4gICAgZXhwZWN0KCgpID0+IG5ldyBEb2NrZXJJbWFnZUFzc2V0KHN0YWNrLCAnTXlBc3NldDInLCB7XG4gICAgICBkaXJlY3Rvcnk6IHBhdGguam9pbihfX2Rpcm5hbWUsICdkZW1vLWltYWdlJyksXG4gICAgICBidWlsZEFyZ3M6IHsga2V5OiB0b2tlbiB9LFxuICAgIH0pKS50b1Rocm93KGV4cGVjdGVkKTtcbiAgfSk7XG5cbiAgdGVzdERlcHJlY2F0ZWQoJ2ZhaWxzIGlmIHVzaW5nIHRva2VuIGFzIHJlcG9zaXRvcnlOYW1lJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgU3RhY2soKTtcbiAgICBjb25zdCB0b2tlbiA9IExhenkuc3RyaW5nKHsgcHJvZHVjZTogKCkgPT4gJ2ZvbycgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KCgpID0+IG5ldyBEb2NrZXJJbWFnZUFzc2V0KHN0YWNrLCAnTXlBc3NldDEnLCB7XG4gICAgICBkaXJlY3Rvcnk6IHBhdGguam9pbihfX2Rpcm5hbWUsICdkZW1vLWltYWdlJyksXG4gICAgICByZXBvc2l0b3J5TmFtZTogdG9rZW4sXG4gICAgfSkpLnRvVGhyb3coL0Nhbm5vdCB1c2UgVG9rZW4gYXMgdmFsdWUgb2YgJ3JlcG9zaXRvcnlOYW1lJy8pO1xuICB9KTtcblxuICB0ZXN0KCdkb2NrZXIgYnVpbGQgb3B0aW9ucyBhcmUgaW5jbHVkZWQgaW4gdGhlIGFzc2V0IGlkJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKGFwcCk7XG4gICAgY29uc3QgZGlyZWN0b3J5ID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJ2RlbW8taW1hZ2UtY3VzdG9tLWRvY2tlci1maWxlJyk7XG5cbiAgICBjb25zdCBhc3NldDEgPSBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjaywgJ0Fzc2V0MScsIHsgZGlyZWN0b3J5IH0pO1xuICAgIGNvbnN0IGFzc2V0MiA9IG5ldyBEb2NrZXJJbWFnZUFzc2V0KHN0YWNrLCAnQXNzZXQyJywgeyBkaXJlY3RvcnksIGZpbGU6ICdEb2NrZXJmaWxlLkN1c3RvbScgfSk7XG4gICAgY29uc3QgYXNzZXQzID0gbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdBc3NldDMnLCB7IGRpcmVjdG9yeSwgdGFyZ2V0OiAnTm9uRGVmYXVsdFRhcmdldCcgfSk7XG4gICAgY29uc3QgYXNzZXQ0ID0gbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdBc3NldDQnLCB7IGRpcmVjdG9yeSwgYnVpbGRBcmdzOiB7IG9wdDE6ICcxMjMnLCBvcHQyOiAnYm9vbScgfSB9KTtcbiAgICBjb25zdCBhc3NldDUgPSBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjaywgJ0Fzc2V0NScsIHsgZGlyZWN0b3J5LCBmaWxlOiAnRG9ja2VyZmlsZS5DdXN0b20nLCB0YXJnZXQ6ICdOb25EZWZhdWx0VGFyZ2V0JyB9KTtcbiAgICBjb25zdCBhc3NldDYgPSBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjaywgJ0Fzc2V0NicsIHsgZGlyZWN0b3J5LCBleHRyYUhhc2g6ICdyYW5kb20tZXh0cmEnIH0pO1xuICAgIGNvbnN0IGFzc2V0NyA9IG5ldyBEb2NrZXJJbWFnZUFzc2V0KHN0YWNrLCAnQXNzZXQ3JywgeyBkaXJlY3RvcnksIG91dHB1dHM6IFsnMTIzJ10gfSk7XG4gICAgY29uc3QgYXNzZXQ4ID0gbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdBc3NldDgnLCB7IGRpcmVjdG9yeSwgYnVpbGRTZWNyZXRzOiB7IG15U2VjcmV0OiBEb2NrZXJCdWlsZFNlY3JldC5mcm9tU3JjKCdhYmMudHh0JykgfSB9KTtcblxuICAgIGV4cGVjdChhc3NldDEuYXNzZXRIYXNoKS50b0VxdWFsKCcxMzI0OGM1NTYzM2YzYjE5OGE2MjhiYjJlYTQ2NjNjYjUyMjZmOGIyODAxMDUxYmQwYzcyNTk1MDI2NmZkNTkwJyk7XG4gICAgZXhwZWN0KGFzc2V0Mi5hc3NldEhhc2gpLnRvRXF1YWwoJzM2YmYyMDVmYjlhZGM1ZTQ1YmExYzhkNTM0MTU4YTBhZWQ5NmQxOTBlZmY0MzNhZjFkOTBmM2I5NGY5NmU3NTEnKTtcbiAgICBleHBlY3QoYXNzZXQzLmFzc2V0SGFzaCkudG9FcXVhbCgnNGM4NWJkNzBlNzMxMTdiNzEyOWMyZGVmYmU2ZGM0MGE4YTM4NzIzMjlmNGRkY2ExOGQ3NWFmYTY3MWIzODI3NicpO1xuICAgIGV4cGVjdChhc3NldDQuYXNzZXRIYXNoKS50b0VxdWFsKCc4YTkxMjE5YTdiYjBmNThiMzI4MmRkODRhY2JmNGMwM2M0OWM3NjViZTU0ZmZiN2IxMjViZTZhNTBiNmM1NjQ1Jyk7XG4gICAgZXhwZWN0KGFzc2V0NS5hc3NldEhhc2gpLnRvRXF1YWwoJ2MwMmJmYmExM2IyZTdlMWZmNWM3NzhhNzZlMTAyOTZiOWU4ZDE3ZjdmODI1MmQwOTdmNDE3MGFlMDRjZTBlYjQnKTtcbiAgICBleHBlY3QoYXNzZXQ2LmFzc2V0SGFzaCkudG9FcXVhbCgnMzUyOGQ2ODM4NjQ3YTVlOTAxMWIwZjM1YWVjNTE0ZDAzYWQxMWFmMDVhOTQ2NTNjZGNmNGRhY2RiYjA3MGEwNicpO1xuICAgIGV4cGVjdChhc3NldDcuYXNzZXRIYXNoKS50b0VxdWFsKCdjZWQwYTMwNzZlZmUyMTdmOWNiZGZmMDk0M2U1NDNmMzZlY2Y3N2Y3MGI5YTZmZTI4Yjg2MzNkZWI3MjhhNDYyJyk7XG4gICAgZXhwZWN0KGFzc2V0OC5hc3NldEhhc2gpLnRvRXF1YWwoJ2ZmYzI3MThlNjE2MTQxZDE4YzhmNDYyM2QxM2NkZmQ2OGNiOGYwMTBjYTVkYjMxYzkxNmM4YjVmMTBjMTYyYmUnKTtcblxuICB9KTtcblxuICB0ZXN0RGVwcmVjYXRlZCgncmVwb3NpdG9yeU5hbWUgaXMgaW5jbHVkZWQgaW4gdGhlIGFzc2V0IGlkJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKCk7XG4gICAgY29uc3QgZGlyZWN0b3J5ID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJ2RlbW8taW1hZ2UtY3VzdG9tLWRvY2tlci1maWxlJyk7XG5cbiAgICBjb25zdCBhc3NldDEgPSBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjaywgJ0Fzc2V0MScsIHsgZGlyZWN0b3J5IH0pO1xuICAgIGNvbnN0IGFzc2V0MiA9IG5ldyBEb2NrZXJJbWFnZUFzc2V0KHN0YWNrLCAnQXNzZXQyJywgeyBkaXJlY3RvcnksIHJlcG9zaXRvcnlOYW1lOiAnZm9vJyB9KTtcblxuICAgIGV4cGVjdChhc3NldDEuYXNzZXRIYXNoKS50b0VxdWFsKCcxMzI0OGM1NTYzM2YzYjE5OGE2MjhiYjJlYTQ2NjNjYjUyMjZmOGIyODAxMDUxYmQwYzcyNTk1MDI2NmZkNTkwJyk7XG4gICAgZXhwZWN0KGFzc2V0Mi5hc3NldEhhc2gpLnRvRXF1YWwoJ2I3ODk3OGNhNzAyYThlY2NkMzc4MDRjZTMxZDc2Y2Q4M2E2OTViNTU3ZGJmOTVhZWIxMDkzMzJlZThiMWZkMzInKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ltYWdlVGFnIGlzIGNvcnJlY3QgZm9yIGRpZmZlcmVudCBzdGFjayBzeW50aGVzaXplcnMnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sxID0gbmV3IFN0YWNrKCk7XG4gICAgY29uc3Qgc3RhY2syID0gbmV3IFN0YWNrKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB7XG4gICAgICBzeW50aGVzaXplcjogbmV3IERlZmF1bHRTdGFja1N5bnRoZXNpemVyKHtcbiAgICAgICAgZG9ja2VyVGFnUHJlZml4OiAnYmFuYW5hJyxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgY29uc3QgZGlyZWN0b3J5ID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJ2RlbW8taW1hZ2UtY3VzdG9tLWRvY2tlci1maWxlJyk7XG5cbiAgICBjb25zdCBhc3NldDEgPSBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjazEsICdBc3NldDEnLCB7IGRpcmVjdG9yeSB9KTtcbiAgICBjb25zdCBhc3NldDIgPSBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjazIsICdBc3NldDInLCB7IGRpcmVjdG9yeSB9KTtcblxuICAgIHRlc3QoJ3N0YWNrIHdpdGggZGVmYXVsdCBzeW50aGVzaXplcicsICgpID0+IHtcbiAgICAgIGV4cGVjdChhc3NldDEuYXNzZXRIYXNoKS50b0VxdWFsKCcxMzI0OGM1NTYzM2YzYjE5OGE2MjhiYjJlYTQ2NjNjYjUyMjZmOGIyODAxMDUxYmQwYzcyNTk1MDI2NmZkNTkwJyk7XG4gICAgICBleHBlY3QoYXNzZXQxLmltYWdlVGFnKS50b0VxdWFsKCcxMzI0OGM1NTYzM2YzYjE5OGE2MjhiYjJlYTQ2NjNjYjUyMjZmOGIyODAxMDUxYmQwYzcyNTk1MDI2NmZkNTkwJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzdGFjayB3aXRoIG92ZXJ3cml0dGVuIHN5bnRoZXNpemVyJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGFzc2V0Mi5hc3NldEhhc2gpLnRvRXF1YWwoJzEzMjQ4YzU1NjMzZjNiMTk4YTYyOGJiMmVhNDY2M2NiNTIyNmY4YjI4MDEwNTFiZDBjNzI1OTUwMjY2ZmQ1OTAnKTtcbiAgICAgIGV4cGVjdChhc3NldDIuaW1hZ2VUYWcpLnRvRXF1YWwoJ2JhbmFuYTEzMjQ4YzU1NjMzZjNiMTk4YTYyOGJiMmVhNDY2M2NiNTIyNmY4YjI4MDEwNTFiZDBjNzI1OTUwMjY2ZmQ1OTAnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZnVuY3Rpb24gdGVzdERvY2tlckRpcmVjdG9yeUlzU3RhZ2VkV2l0aG91dEZpbGVzU3BlY2lmaWVkSW5Eb2NrZXJpZ25vcmUoYXBwOiBBcHAsIGlnbm9yZU1vZGU/OiBJZ25vcmVNb2RlKSB7XG4gIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKGFwcCk7XG4gIGNvbnN0IGltYWdlID0gbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2ssICdNeUFzc2V0Jywge1xuICAgIGlnbm9yZU1vZGUsXG4gICAgZGlyZWN0b3J5OiBwYXRoLmpvaW4oX19kaXJuYW1lLCAnZG9ja2VyaWdub3JlLWltYWdlJyksXG4gIH0pO1xuXG4gIGNvbnN0IHNlc3Npb24gPSBhcHAuc3ludGgoKTtcblxuICAvLyAuZG9ja2VyaWdub3JlIGl0c2VsZiBzaG91bGQgYmUgaW5jbHVkZWQgaW4gb3V0cHV0IHRvIGJlIHByb2Nlc3NlZCBkdXJpbmcgZG9ja2VyIGJ1aWxkXG4gIGV4cGVjdChmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICcuZG9ja2VyaWdub3JlJykpKS50b0JlKHRydWUpO1xuICBleHBlY3QoZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oc2Vzc2lvbi5kaXJlY3RvcnksIGBhc3NldC4ke2ltYWdlLmFzc2V0SGFzaH1gLCAnRG9ja2VyZmlsZScpKSkudG9CZSh0cnVlKTtcbiAgZXhwZWN0KGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ2luZGV4LnB5JykpKS50b0JlKHRydWUpO1xuICBleHBlY3QoIWZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ2Zvb2Jhci50eHQnKSkpLnRvQmUodHJ1ZSk7XG4gIGV4cGVjdChmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICdzdWJkaXJlY3RvcnknKSkpLnRvQmUodHJ1ZSk7XG4gIGV4cGVjdChmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICdzdWJkaXJlY3RvcnknLCAnYmF6LnR4dCcpKSkudG9CZSh0cnVlKTtcbn1cblxuZnVuY3Rpb24gdGVzdERvY2tlckRpcmVjdG9yeUlzU3RhZ2VkV2l0aG91dEZpbGVzU3BlY2lmaWVkSW5FeGNsdWRlT3B0aW9uKGFwcDogQXBwLCBpZ25vcmVNb2RlPzogSWdub3JlTW9kZSkge1xuICBjb25zdCBzdGFjayA9IG5ldyBTdGFjayhhcHApO1xuICBjb25zdCBpbWFnZSA9IG5ldyBEb2NrZXJJbWFnZUFzc2V0KHN0YWNrLCAnTXlBc3NldCcsIHtcbiAgICBkaXJlY3Rvcnk6IHBhdGguam9pbihfX2Rpcm5hbWUsICdkb2NrZXJpZ25vcmUtaW1hZ2UnKSxcbiAgICBleGNsdWRlOiBbJ3N1YmRpcmVjdG9yeSddLFxuICAgIGlnbm9yZU1vZGUsXG4gIH0pO1xuXG4gIGNvbnN0IHNlc3Npb24gPSBhcHAuc3ludGgoKTtcblxuICBleHBlY3QoZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oc2Vzc2lvbi5kaXJlY3RvcnksIGBhc3NldC4ke2ltYWdlLmFzc2V0SGFzaH1gLCAnLmRvY2tlcmlnbm9yZScpKSkudG9CZSh0cnVlKTtcbiAgZXhwZWN0KGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ0RvY2tlcmZpbGUnKSkpLnRvQmUodHJ1ZSk7XG4gIGV4cGVjdChmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICdpbmRleC5weScpKSkudG9CZSh0cnVlKTtcbiAgZXhwZWN0KCFmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICdmb29iYXIudHh0JykpKS50b0JlKHRydWUpO1xuICBleHBlY3QoIWZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHNlc3Npb24uZGlyZWN0b3J5LCBgYXNzZXQuJHtpbWFnZS5hc3NldEhhc2h9YCwgJ3N1YmRpcmVjdG9yeScpKSkudG9CZSh0cnVlKTtcbiAgZXhwZWN0KCFmcy5leGlzdHNTeW5jKHBhdGguam9pbihzZXNzaW9uLmRpcmVjdG9yeSwgYGFzc2V0LiR7aW1hZ2UuYXNzZXRIYXNofWAsICdzdWJkaXJlY3RvcnknLCAnYmF6LnR4dCcpKSkudG9CZSh0cnVlKTtcbn1cblxudGVzdCgnbmVzdGVkIGFzc2VtYmxpZXMgc2hhcmUgYXNzZXRzOiBsZWdhY3kgc3ludGggZWRpdGlvbicsICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuICBjb25zdCBzdGFjazEgPSBuZXcgU3RhY2sobmV3IFN0YWdlKGFwcCwgJ1N0YWdlMScpLCAnU3RhY2snLCB7IHN5bnRoZXNpemVyOiBuZXcgTGVnYWN5U3RhY2tTeW50aGVzaXplcigpIH0pO1xuICBjb25zdCBzdGFjazIgPSBuZXcgU3RhY2sobmV3IFN0YWdlKGFwcCwgJ1N0YWdlMicpLCAnU3RhY2snLCB7IHN5bnRoZXNpemVyOiBuZXcgTGVnYWN5U3RhY2tTeW50aGVzaXplcigpIH0pO1xuXG4gIC8vIFdIRU5cbiAgbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2sxLCAnSW1hZ2UnLCB7IGRpcmVjdG9yeTogcGF0aC5qb2luKF9fZGlybmFtZSwgJ2RlbW8taW1hZ2UnKSB9KTtcbiAgbmV3IERvY2tlckltYWdlQXNzZXQoc3RhY2syLCAnSW1hZ2UnLCB7IGRpcmVjdG9yeTogcGF0aC5qb2luKF9fZGlybmFtZSwgJ2RlbW8taW1hZ2UnKSB9KTtcblxuICAvLyBUSEVOXG4gIGNvbnN0IGFzc2VtYmx5ID0gYXBwLnN5bnRoKCk7XG5cbiAgLy8gUmVhZCB0aGUgYXNzZXRzIGZyb20gdGhlIHN0YWNrIG1ldGFkYXRhXG4gIGZvciAoY29uc3Qgc3RhZ2VOYW1lIG9mIFsnU3RhZ2UxJywgJ1N0YWdlMiddKSB7XG4gICAgY29uc3Qgc3RhY2tBcnRpZmFjdCA9IGFzc2VtYmx5LmdldE5lc3RlZEFzc2VtYmx5KGBhc3NlbWJseS0ke3N0YWdlTmFtZX1gKS5hcnRpZmFjdHMuZmlsdGVyKGlzU3RhY2tBcnRpZmFjdClbMF07XG4gICAgY29uc3QgYXNzZXRNZXRhID0gc3RhY2tBcnRpZmFjdC5maW5kTWV0YWRhdGFCeVR5cGUoY3hzY2hlbWEuQXJ0aWZhY3RNZXRhZGF0YUVudHJ5VHlwZS5BU1NFVCk7XG4gICAgZXhwZWN0KGFzc2V0TWV0YVswXSkudG9FcXVhbChcbiAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgZGF0YTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHBhdGg6IGAuLi9hc3NldC4ke0RFTU9fSU1BR0VfQVNTRVRfSEFTSH1gLFxuICAgICAgICB9KSxcbiAgICAgIH0pLFxuICAgICk7XG4gIH1cbn0pO1xuXG50ZXN0KCduZXN0ZWQgYXNzZW1ibGllcyBzaGFyZSBhc3NldHM6IGRlZmF1bHQgc3ludGggZWRpdGlvbicsICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuICBjb25zdCBzdGFjazEgPSBuZXcgU3RhY2sobmV3IFN0YWdlKGFwcCwgJ1N0YWdlMScpLCAnU3RhY2snLCB7IHN5bnRoZXNpemVyOiBuZXcgRGVmYXVsdFN0YWNrU3ludGhlc2l6ZXIoKSB9KTtcbiAgY29uc3Qgc3RhY2syID0gbmV3IFN0YWNrKG5ldyBTdGFnZShhcHAsICdTdGFnZTInKSwgJ1N0YWNrJywgeyBzeW50aGVzaXplcjogbmV3IERlZmF1bHRTdGFja1N5bnRoZXNpemVyKCkgfSk7XG5cbiAgLy8gV0hFTlxuICBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjazEsICdJbWFnZScsIHsgZGlyZWN0b3J5OiBwYXRoLmpvaW4oX19kaXJuYW1lLCAnZGVtby1pbWFnZScpIH0pO1xuICBuZXcgRG9ja2VySW1hZ2VBc3NldChzdGFjazIsICdJbWFnZScsIHsgZGlyZWN0b3J5OiBwYXRoLmpvaW4oX19kaXJuYW1lLCAnZGVtby1pbWFnZScpIH0pO1xuXG4gIC8vIFRIRU5cbiAgY29uc3QgYXNzZW1ibHkgPSBhcHAuc3ludGgoKTtcblxuICAvLyBSZWFkIHRoZSBhc3NldCBtYW5pZmVzdHMgdG8gdmVyaWZ5IHRoZSBmaWxlIHBhdGhzXG4gIGZvciAoY29uc3Qgc3RhZ2VOYW1lIG9mIFsnU3RhZ2UxJywgJ1N0YWdlMiddKSB7XG4gICAgY29uc3QgbWFuaWZlc3RBcnRpZmFjdCA9IGFzc2VtYmx5LmdldE5lc3RlZEFzc2VtYmx5KGBhc3NlbWJseS0ke3N0YWdlTmFtZX1gKS5hcnRpZmFjdHMuZmlsdGVyKGN4YXBpLkFzc2V0TWFuaWZlc3RBcnRpZmFjdC5pc0Fzc2V0TWFuaWZlc3RBcnRpZmFjdClbMF07XG4gICAgY29uc3QgbWFuaWZlc3QgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhtYW5pZmVzdEFydGlmYWN0LmZpbGUsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSkpO1xuXG4gICAgZXhwZWN0KG1hbmlmZXN0LmRvY2tlckltYWdlc1tERU1PX0lNQUdFX0FTU0VUX0hBU0hdLnNvdXJjZSkudG9FcXVhbCh7XG4gICAgICBkaXJlY3Rvcnk6IGAuLi9hc3NldC4ke0RFTU9fSU1BR0VfQVNTRVRfSEFTSH1gLFxuICAgIH0pO1xuICB9XG59KTtcblxuZnVuY3Rpb24gaXNTdGFja0FydGlmYWN0KHg6IGFueSk6IHggaXMgY3hhcGkuQ2xvdWRGb3JtYXRpb25TdGFja0FydGlmYWN0IHtcbiAgcmV0dXJuIHggaW5zdGFuY2VvZiBjeGFwaS5DbG91ZEZvcm1hdGlvblN0YWNrQXJ0aWZhY3Q7XG59XG4iXX0=