"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addDefaultCapacityProvider = void 0;
const autoscaling = require("@aws-cdk/aws-autoscaling");
const ec2 = require("@aws-cdk/aws-ec2");
const ecs = require("../lib");
function addDefaultCapacityProvider(cluster, stack, vpc, props) {
    const autoScalingGroup = new autoscaling.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
        vpc,
        machineImage: ecs.EcsOptimizedImage.amazonLinux2(),
        instanceType: new ec2.InstanceType('t2.micro'),
    });
    const provider = new ecs.AsgCapacityProvider(stack, 'AsgCapacityProvider', {
        ...props,
        autoScalingGroup,
    });
    cluster.addAsgCapacityProvider(provider);
    cluster.connections.addSecurityGroup(...autoScalingGroup.connections.securityGroups);
}
exports.addDefaultCapacityProvider = addDefaultCapacityProvider;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsd0RBQXdEO0FBQ3hELHdDQUF3QztBQUV4Qyw4QkFBOEI7QUFFOUIsU0FBZ0IsMEJBQTBCLENBQUMsT0FBb0IsRUFDN0QsS0FBZ0IsRUFDaEIsR0FBWSxFQUNaLEtBQThEO0lBQzlELE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxXQUFXLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLHlCQUF5QixFQUFFO1FBQzFGLEdBQUc7UUFDSCxZQUFZLEVBQUUsR0FBRyxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRTtRQUNsRCxZQUFZLEVBQUUsSUFBSSxHQUFHLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQztLQUMvQyxDQUFDLENBQUM7SUFDSCxNQUFNLFFBQVEsR0FBRyxJQUFJLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxLQUFLLEVBQUUscUJBQXFCLEVBQUU7UUFDekUsR0FBRyxLQUFLO1FBQ1IsZ0JBQWdCO0tBQ2pCLENBQUMsQ0FBQztJQUNILE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN6QyxPQUFPLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQ3ZGLENBQUM7QUFmRCxnRUFlQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGF1dG9zY2FsaW5nIGZyb20gJ0Bhd3MtY2RrL2F3cy1hdXRvc2NhbGluZyc7XG5pbXBvcnQgKiBhcyBlYzIgZnJvbSAnQGF3cy1jZGsvYXdzLWVjMic7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSAnQGF3cy1jZGsvY29yZSc7XG5pbXBvcnQgKiBhcyBlY3MgZnJvbSAnLi4vbGliJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZERlZmF1bHRDYXBhY2l0eVByb3ZpZGVyKGNsdXN0ZXI6IGVjcy5DbHVzdGVyLFxuICBzdGFjazogY2RrLlN0YWNrLFxuICB2cGM6IGVjMi5WcGMsXG4gIHByb3BzPzogT21pdDxlY3MuQXNnQ2FwYWNpdHlQcm92aWRlclByb3BzLCAnYXV0b1NjYWxpbmdHcm91cCc+KSB7XG4gIGNvbnN0IGF1dG9TY2FsaW5nR3JvdXAgPSBuZXcgYXV0b3NjYWxpbmcuQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgIHZwYyxcbiAgICBtYWNoaW5lSW1hZ2U6IGVjcy5FY3NPcHRpbWl6ZWRJbWFnZS5hbWF6b25MaW51eDIoKSxcbiAgICBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCd0Mi5taWNybycpLFxuICB9KTtcbiAgY29uc3QgcHJvdmlkZXIgPSBuZXcgZWNzLkFzZ0NhcGFjaXR5UHJvdmlkZXIoc3RhY2ssICdBc2dDYXBhY2l0eVByb3ZpZGVyJywge1xuICAgIC4uLnByb3BzLFxuICAgIGF1dG9TY2FsaW5nR3JvdXAsXG4gIH0pO1xuICBjbHVzdGVyLmFkZEFzZ0NhcGFjaXR5UHJvdmlkZXIocHJvdmlkZXIpO1xuICBjbHVzdGVyLmNvbm5lY3Rpb25zLmFkZFNlY3VyaXR5R3JvdXAoLi4uYXV0b1NjYWxpbmdHcm91cC5jb25uZWN0aW9ucy5zZWN1cml0eUdyb3Vwcyk7XG59XG4iXX0=